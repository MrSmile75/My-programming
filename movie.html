<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmileX - Movie Streaming Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
</head>

<style>
    :root {
        --primary-bg: #0a0a0a;
        --secondary-bg: #1a1a1a;
        --accent-color: #e50914;
        --accent-hover: #f40612;
        --text-color: #ffffff;
        --text-secondary: #b3b3b3;
        --overlay-bg: rgba(0,0,0,0.9);
        --success-color: #28a745;
        --warning-color: #ffc107;
        --error-color: #dc3545;
        --border-radius: 12px;
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        background: linear-gradient(135deg, var(--primary-bg) 0%, #1a1a2e 100%);
        color: var(--text-color);
        font-family: 'Orbitron', sans-serif;
        line-height: 1.6;
        overflow-x: hidden;
    }

    input {
        font-family: 'Orbitron', sans-serif;
    }

    /* Preloader Styles */
    #preloader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, #000000, #1a1a2e, #16213e);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        transition: opacity 0.8s ease, transform 0.8s ease;
    }

    .loader-container {
        text-align: center;
        perspective: 1000px;
    }

    .loader {
        width: 120px;
        height: 120px;
        border: 4px solid transparent;
        border-top: 4px solid var(--accent-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 30px;
        position: relative;
    }

    .loader::before {
        content: '';
        position: absolute;
        top: 5px;
        left: 5px;
        right: 5px;
        bottom: 5px;
        border: 4px solid transparent;
        border-top: 4px solid #ff6b6b;
        border-radius: 50%;
        animation: spin 2s linear infinite reverse;
    }

    .loader-text {
        font-family: 'Orbitron', sans-serif;
        font-size: 24px;
        color: var(--accent-color);
        margin-bottom: 20px;
        text-shadow: 0 0 20px rgba(229, 9, 20, 0.5);
    }

    .progress-bar {
        width: 300px;
        height: 6px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 3px;
        overflow: hidden;
        margin: 20px auto;
    }

    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--accent-color), #ff6b6b);
        width: 0%;
        transition: width 0.3s ease;
        border-radius: 3px;
    }

    .loading-status {
        color: var(--text-secondary);
        font-size: 14px;
        margin-top: 10px;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .fade-out {
        opacity: 0;
        transform: scale(1.1);
    }

    /* Navigation Styles */
    .navbar {
        position: fixed;
        top: 0;
        width: 100%;
        background: rgba(10, 10, 10, 0.95);
        backdrop-filter: blur(20px);
        padding: 15px 5%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 1000;
        border-bottom: 1px solid rgba(229, 9, 20, 0.2);
        transition: var(--transition);
    }

    .logo {
        font-family: 'Orbitron', sans-serif;
        font-size: 28px;
        font-weight: 700;
        color: var(--accent-color);
        text-shadow: 0 0 20px rgba(229, 9, 20, 0.5);
        cursor: pointer;
        transition: var(--transition);
    }

    .logo:hover {
        transform: scale(1.05);
        text-shadow: 0 0 30px rgba(229, 9, 20, 0.8);
    }

    .search-container {
        position: relative;
        display: flex;
        align-items: center;
    }

    .search-input {
        background: rgba(255, 255, 255, 0.1);
        border: 2px solid rgba(229, 9, 20, 0.3);
        border-radius: 25px;
        padding: 12px 50px 12px 20px;
        color: var(--text-color);
        font-size: 16px;
        width: 350px;
        transition: var(--transition);
        backdrop-filter: blur(10px);
    }

    .search-input:focus {
        outline: none;
        border-color: var(--accent-color);
        box-shadow: 0 0 20px rgba(229, 9, 20, 0.3);
        transform: scale(1.02);
    }

    .search-input::placeholder {
        color: var(--text-secondary);
    }

    .search-btn {
        position: absolute;
        right: 15px;
        background: none;
        border: none;
        color: var(--accent-color);
        font-size: 18px;
        cursor: pointer;
        transition: var(--transition);
    }

    .search-btn:hover {
        transform: scale(1.1);
    }

    /* Modal Styles */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--overlay-bg);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        backdrop-filter: blur(10px);
        animation: fadeIn 0.3s ease;
    }

    .modal-overlay.show {
        display: flex;
    }

    .modal-content {
        background: var(--secondary-bg);
        border-radius: var(--border-radius);
        max-width: 600px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
        border: 2px solid var(--accent-color);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        animation: slideUp 0.3s ease;
        position: relative;
    }

    .modal-header {
        padding: 20px;
        border-bottom: 1px solid rgba(229, 9, 20, 0.2);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .modal-title {
        font-size: 24px;
        color: var(--accent-color);
        margin: 0;
    }

    .close-btn {
        background: none;
        border: none;
        color: var(--text-color);
        font-size: 24px;
        cursor: pointer;
        transition: var(--transition);
    }

    .close-btn:hover {
        color: var(--accent-color);
        transform: scale(1.1);
    }

    .modal-body {
        padding: 20px;
    }

    .movie-details {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
    }

    .movie-poster-large {
        width: 200px;
        height: 300px;
        object-fit: cover;
        border-radius: var(--border-radius);
        border: 2px solid var(--accent-color);
    }

    .movie-info-details {
        flex: 1;
    }

    .movie-meta {
        display: flex;
        gap: 15px;
        margin-bottom: 15px;
        flex-wrap: wrap;
    }

    .meta-item {
        background: rgba(229, 9, 20, 0.1);
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 12px;
        border: 1px solid rgba(229, 9, 20, 0.3);
    }

    .movie-description {
        color: var(--text-secondary);
        line-height: 1.6;
        margin-bottom: 20px;
    }

    .watch-movie-btn {
        background: var(--accent-color);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: var(--border-radius);
        font-size: 16px;
        cursor: pointer;
        transition: var(--transition);
        font-family: 'Orbitron', sans-serif;
        font-weight: 600;
        width: 100%;
    }

    .watch-movie-btn:hover {
        background: var(--accent-hover);
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(229, 9, 20, 0.3);
    }

    /* Watch Options Modal */
    .watch-options {
        text-align: center;
    }

    .watch-option-btn {
        background: var(--secondary-bg);
        color: var(--text-color);
        border: 2px solid var(--accent-color);
        padding: 15px 30px;
        border-radius: var(--border-radius);
        font-size: 16px;
        cursor: pointer;
        transition: var(--transition);
        font-family: 'Orbitron', sans-serif;
        font-weight: 600;
        width: 100%;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
    }

    .watch-option-btn:hover {
        background: var(--accent-color);
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(229, 9, 20, 0.3);
    }

    .watch-option-btn:last-child {
        margin-bottom: 0;
    }

        .watch-options {
        text-align: center;
    }

    .watch-option-btn1 {
  pointer-events: none;       /* disables mouse/tap clicks */
  opacity: 0.6;               /* visual cue for "disabled" */
  user-select: none;          /* prevents text selection */
    background: var(--secondary-bg);
        color: var(--text-color);
        border: 2px solid var(--accent-color);
        padding: 15px 30px;
        border-radius: var(--border-radius);
        font-size: 16px;
          font-family: 'Orbitron', sans-serif;
        font-weight: 600;
        width: 100%;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
    }

    .watch-option-btn1:focus {
  outline: none;              /* removes keyboard focus */
}
    .watch-option-btn1 [aria-disabled="true"] {
  cursor: not-allowed;        /* show disabled cursor */
}


    /* Error Handling Styles */
    .error-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--overlay-bg);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        backdrop-filter: blur(10px);
    }

    .error-content {
        background: var(--secondary-bg);
        padding: 40px;
        border-radius: var(--border-radius);
        text-align: center;
        max-width: 500px;
        border: 2px solid var(--error-color);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
    }

    .error-icon {
        font-size: 60px;
        color: var(--error-color);
        margin-bottom: 20px;
    }

    .error-title {
        font-size: 24px;
        margin-bottom: 15px;
        color: var(--error-color);
    }

    .error-message {
        color: var(--text-secondary);
        margin-bottom: 30px;
        line-height: 1.6;
    }

    .retry-btn {
        background: var(--accent-color);
        color: white;
        border: none;
        padding: 12px 30px;
        border-radius: var(--border-radius);
        font-size: 16px;
        cursor: pointer;
        transition: var(--transition);
        font-family: 'Orbitron', sans-serif;
    }

    .retry-btn:hover {
        background: var(--accent-hover);
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(229, 9, 20, 0.3);
    }

    /* Main Content Styles */
    .main-content {
        margin-top: 80px;
        padding: 20px 5%;
        min-height: calc(100vh - 80px);
    }

    .section-title {
        font-family: 'Orbitron', sans-serif;
        font-size: 32px;
        margin-bottom: 30px;
        text-align: center;
        background: linear-gradient(45deg, var(--accent-color), #ff6b6b);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    /* Movie Grid Styles */
    .movie-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 30px;
        margin-bottom: 50px;
    }

    .movie-card {
        background: var(--secondary-bg);
        border-radius: var(--border-radius);
        overflow: hidden;
        position: relative;
        transition: var(--transition);
        border: 2px solid transparent;
        cursor: pointer;
    }

    .movie-card:hover {
        transform: translateY(-10px) scale(1.02);
        border-color: var(--accent-color);
        box-shadow: 0 20px 40px rgba(229, 9, 20, 0.2);
    }

    .movie-poster {
        width: 100%;
        height: 400px;
        object-fit: cover;
        transition: var(--transition);
    }

    .movie-card:hover .movie-poster {
        transform: scale(1.05);
    }

    .movie-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(transparent, rgba(0,0,0,0.9));
        padding: 20px;
        transform: translateY(100%);
        transition: var(--transition);
    }

    .movie-card:hover .movie-overlay {
        transform: translateY(0);
    }

    .movie-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 10px;
        color: var(--text-color);
    }

    .movie-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }

    .movie-rating {
        background: var(--accent-color);
        color: white;
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
    }

    .movie-year {
        color: var(--text-secondary);
        font-size: 14px;
    }

    .movie-actions {
        display: flex;
        gap: 10px;
    }

    .action-btn {
        flex: 1;
        padding: 10px;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        cursor: pointer;
        transition: var(--transition);
        font-weight: 600;
    }

    .preview-btn {
        background: rgba(255, 255, 255, 0.1);
        color: var(--text-color);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .preview-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
    }

    .watch-btn {
        background: var(--accent-color);
        color: white;
        border: 1px solid var(--accent-color);
    }

    .watch-btn:hover {
        background: var(--accent-hover);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(229, 9, 20, 0.4);
    }

    /* Loading States */
    .loading-container {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 200px;
        flex-direction: column;
    }

    .loading-spinner {
        width: 50px;
        height: 50px;
        border: 3px solid rgba(229, 9, 20, 0.3);
        border-top: 3px solid var(--accent-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
    }

    .loading-text {
        color: var(--text-secondary);
        font-size: 16px;
    }

    /* Cache Status Indicator */
    .cache-indicator {
        position: fixed;
        top: 90px;
        right: 20px;
        background: var(--success-color);
        color: white;
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 12px;
        z-index: 1000;
        opacity: 0;
        transform: translateX(100%);
        transition: var(--transition);
    }

    .cache-indicator.show {
        opacity: 1;
        transform: translateX(0);
    }

    .cache-indicator.warning {
        background: var(--warning-color);
    }

    /* Animations */
    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }

    @keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(50px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .fade-in {
        animation: fadeIn 0.6s ease forwards;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .navbar {
            flex-direction: column;
            gap: 15px;
            padding: 15px;
        }

        .search-input {
            width: 100%;
            max-width: 300px;
        }

        .movie-grid {
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .section-title {
            font-size: 24px;
        }

        .main-content {
            margin-top: 120px;
        }

        .movie-details {
            flex-direction: column;
            text-align: center;
        }

        .movie-poster-large {
            width: 150px;
            height: 225px;
            margin: 0 auto;
        }
    }

    @media (max-width: 480px) {
        .movie-grid {
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .logo {
            font-size: 20px;
        }

        .modal-content {
            width: 95%;
        }
    }

    /* Scrollbar Styling */
    ::-webkit-scrollbar {
        width: 8px;
    }

    ::-webkit-scrollbar-track {
        background: var(--primary-bg);
    }

    ::-webkit-scrollbar-thumb {
        background: var(--accent-color);
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: var(--accent-hover);
    }
</style>

<body>
    <!-- Preloader -->
    <div id="preloader">
        <div class="loader-container">
            <div class="loader"></div>
            <div class="loader-text">SMILEX</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="loading-status" id="loading-status">Initializing...</div>
        </div>
    </div>

    <!-- Error Overlay -->
    <div id="error-overlay" class="error-overlay">
        <div class="error-content">
            <div class="error-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h2 class="error-title">Oops! Something went wrong</h2>
            <p class="error-message" id="error-message">
                We're having trouble connecting to our servers. Please check your internet connection and try again.
            </p>
            <button class="retry-btn" id="retry-btn">
                <i class="fas fa-redo"></i> Try Again
            </button>
        </div>
    </div>

    <!-- Movie Details Modal -->
    <div id="movie-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-movie-title">Movie Details</h2>
                <button class="close-btn" onclick="closeModal('movie-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="movie-details">
                    <img id="modal-movie-poster" class="movie-poster-large" src="/placeholder.svg" alt="Movie Poster">
                    <div class="movie-info-details">
                        <div class="movie-meta" id="modal-movie-meta">
                            <!-- Meta information will be inserted here -->
                        </div>
                        <div class="movie-description" id="modal-movie-description">
                            <!-- Movie description will be inserted here -->
                        </div>
                    </div>
                </div>
                <button class="watch-movie-btn" id="watch-movie-btn">
                    <i class="fas fa-play"></i> Watch Movie
                </button>
            </div>
        </div>
    </div>

    <!-- Watch Options Modal -->
    <div id="watch-options-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Choose Watch Option</h2>
                <button class="close-btn" onclick="closeModal('watch-options-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="watch-options">
                    <button class="watch-option-btn" id="watch-tubi-btn">
                        <i class="fas fa-external-link-alt"></i>
                        Watch Full Movie at Netflix.com
                    </button>
                    <button class="watch-option-btn1" id="watch-web-btn" tabindex="-1" aria-disabled="true">
                        <i class="fas fa-play-circle"></i>
                        Watch in Web
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cache Status Indicator -->
    <div id="cache-indicator" class="cache-indicator">
        <i class="fas fa-check"></i> Data cached successfully
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="logo" onclick="location.reload()">
            <i class="fas fa-film"></i> SMILEX
        </div>
        <div class="search-container">
            <input type="text" class="search-input" id="search-input" placeholder="Search for movies...">
            <button class="search-btn" id="search-btn">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content" id="main-content" style="display: none;">
        <h1 class="section-title">Trending Movies</h1>
        <div class="movie-grid" id="movie-grid">
            <!-- Movies will be loaded here -->
        </div>
        
        <div class="loading-container" id="loading-container" style="display: none;">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading amazing movies...</div>
        </div>
    </div>

    <script>
        class CinemaVerseApp {
            constructor() {
                // Configuration
                this.API_KEY = '48ea0449a84effd8baed92d45fa6175f';
                this.BASE_URL = 'https://api.themoviedb.org/3';
                this.IMG_BASE_URL = 'https://image.tmdb.org/t/p/w500';
                this.CACHE_DURATION = 30 * 60 * 1000; // 30 minutes
                this.REQUEST_DELAY = 1000; // 1 second between requests
                
                // State management
                this.cache = new Map();
                this.lastRequestTime = 0;
                this.isLoading = false;
                this.currentPage = 1;
                this.currentMovie = null;
                
                // Initialize app
                this.init();
            }

            async init() {
                try {
                    await this.showPreloader();
                    this.setupEventListeners();
                    await this.loadTrendingMovies();
                    this.hidePreloader();
                    this.showCacheStatus('Data loaded successfully', 'success');
                } catch (error) {
                    this.handleError(error, 'Failed to initialize the application');
                }
            }

            showPreloader() {
                return new Promise((resolve) => {
                    const progressFill = document.getElementById('progress-fill');
                    const loadingStatus = document.getElementById('loading-status');
                    
                    const steps = [
                        { progress: 20, status: 'Connecting to servers...' },
                        { progress: 40, status: 'Loading movie database...' },
                        { progress: 60, status: 'Preparing recommendations...' },
                        { progress: 80, status: 'Optimizing experience...' },
                        { progress: 100, status: 'Ready to stream!' }
                    ];

                    let currentStep = 0;
                    const updateProgress = () => {
                        if (currentStep < steps.length) {
                            const step = steps[currentStep];
                            progressFill.style.width = `${step.progress}%`;
                            loadingStatus.textContent = step.status;
                            currentStep++;
                            setTimeout(updateProgress, 800);
                        } else {
                            setTimeout(resolve, 500);
                        }
                    };

                    updateProgress();
                });
            }

            hidePreloader() {
                const preloader = document.getElementById('preloader');
                const mainContent = document.getElementById('main-content');
                
                preloader.classList.add('fade-out');
                setTimeout(() => {
                    preloader.style.display = 'none';
                    mainContent.style.display = 'block';
                    mainContent.classList.add('fade-in');
                }, 800);
            }

            setupEventListeners() {
                const searchInput = document.getElementById('search-input');
                const searchBtn = document.getElementById('search-btn');
                const retryBtn = document.getElementById('retry-btn');
                const watchMovieBtn = document.getElementById('watch-movie-btn');
                const watchTubiBtn = document.getElementById('watch-tubi-btn');
                const watchWebBtn = document.getElementById('watch-web-btn');

                // Search functionality
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.searchMovies();
                    }
                });

                searchBtn.addEventListener('click', () => {
                    this.searchMovies();
                });

                // Retry functionality
                retryBtn.addEventListener('click', () => {
                    this.hideError();
                    this.init();
                });

                // Watch movie button
                watchMovieBtn.addEventListener('click', () => {
                    this.showWatchOptions();
                });

                // Watch options
                watchTubiBtn.addEventListener('click', () => {
                    this.watchOnTubi();
                });

                watchWebBtn.addEventListener('click', () => {
                    this.watchInWeb();
                });

                // Close modals when clicking outside
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('modal-overlay')) {
                        this.closeAllModals();
                    }
                });

                // Infinite scroll
                window.addEventListener('scroll', () => {
                    if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 1000) {
                        this.loadMoreMovies();
                    }
                });
            }

            async makeAPIRequest(endpoint, useCache = true) {
                // Rate limiting
                const now = Date.now();
                const timeSinceLastRequest = now - this.lastRequestTime;
                if (timeSinceLastRequest < this.REQUEST_DELAY) {
                    await new Promise(resolve => setTimeout(resolve, this.REQUEST_DELAY - timeSinceLastRequest));
                }

                // Check cache first
                if (useCache && this.cache.has(endpoint)) {
                    const cached = this.cache.get(endpoint);
                    if (now - cached.timestamp < this.CACHE_DURATION) {
                        this.showCacheStatus('Using cached data', 'success');
                        return cached.data;
                    }
                }

                try {
                    this.lastRequestTime = Date.now();
                    const response = await fetch(`${this.BASE_URL}${endpoint}`);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const data = await response.json();
                    
                    // Cache the response
                    this.cache.set(endpoint, {
                        data: data,
                        timestamp: now
                    });

                    this.showCacheStatus('Data cached successfully', 'success');
                    return data;

                } catch (error) {
                    // Try to use stale cache data if available
                    if (this.cache.has(endpoint)) {
                        this.showCacheStatus('Using offline data', 'warning');
                        return this.cache.get(endpoint).data;
                    }
                    throw error;
                }
            }

            async loadTrendingMovies() {
                if (this.isLoading) return;
                
                this.isLoading = true;
                this.showLoading();

                try {
                    const data = await this.makeAPIRequest(`/trending/movie/week?api_key=${this.API_KEY}&page=${this.currentPage}`);
                    this.renderMovies(data.results);
                } catch (error) {
                    this.handleError(error, 'Failed to load trending movies. Please try again later.');
                } finally {
                    this.isLoading = false;
                    this.hideLoading();
                }
            }

            async searchMovies() {
                const query = document.getElementById('search-input').value.trim();
                if (!query) return;

                if (this.isLoading) return;
                
                this.isLoading = true;
                this.showLoading();
                this.clearMovies();

                try {
                    const data = await this.makeAPIRequest(`/search/movie?api_key=${this.API_KEY}&query=${encodeURIComponent(query)}`);
                    
                    if (data.results.length === 0) {
                        this.showNoResults();
                    } else {
                        this.renderMovies(data.results);
                    }
                } catch (error) {
                    this.handleError(error, 'Failed to search movies. Please check your connection and try again.');
                } finally {
                    this.isLoading = false;
                    this.hideLoading();
                }
            }

            async loadMoreMovies() {
                if (this.isLoading) return;
                
                this.currentPage++;
                await this.loadTrendingMovies();
            }

            renderMovies(movies) {
                const movieGrid = document.getElementById('movie-grid');
                
                movies.forEach(movie => {
                    if (!movie.poster_path) return; // Skip movies without posters
                    
                    const movieCard = this.createMovieCard(movie);
                    movieGrid.appendChild(movieCard);
                });
            }

            createMovieCard(movie) {
                const movieCard = document.createElement('div');
                movieCard.className = 'movie-card fade-in';
                
                const releaseYear = movie.release_date ? new Date(movie.release_date).getFullYear() : 'N/A';
                const rating = movie.vote_average ? movie.vote_average.toFixed(1) : 'N/A';
                
                movieCard.innerHTML = `
                    <img src="${this.IMG_BASE_URL}${movie.poster_path}" 
                         alt="${movie.title}" 
                         class="movie-poster"
                         loading="lazy">
                    <div class="movie-overlay">
                        <h3 class="movie-title">${movie.title}</h3>
                        <div class="movie-info">
                            <span class="movie-rating">★ ${rating}</span>
                            <span class="movie-year">${releaseYear}</span>
                        </div>
                        <div class="movie-actions">
                            <button class="action-btn preview-btn" onclick="cinemaApp.previewMovie(${movie.id})">
                                <i class="fas fa-play"></i> Preview
                            </button>
                            <button class="action-btn watch-btn" onclick="cinemaApp.watchFullMovie(${movie.id})">
                                <i class="fas fa-info-circle"></i> See more
                            </button>
                        </div>
                    </div>
                `;

                return movieCard;
            }

            async previewMovie(movieId) {
                try {
                    const data = await this.makeAPIRequest(`/movie/${movieId}/videos?api_key=${this.API_KEY}`);
                    const trailer = data.results.find(video => 
                        video.site === 'YouTube' && 
                        (video.type === 'Trailer' || video.type === 'Teaser')
                    );

                    if (trailer) {
                        window.open(`https://www.youtube.com/watch?v=${trailer.key}`, '_blank');
                    } else {
                        this.showNotification('No trailer available for this movie', 'warning');
                    }
                } catch (error) {
                    this.showNotification('Failed to load movie trailer', 'error');
                }
            }

            async watchFullMovie(movieId) {
                try {
                    // Fetch movie details
                    const movieData = await this.makeAPIRequest(`/movie/${movieId}?api_key=${this.API_KEY}`);
                    this.currentMovie = movieData;
                    
                    // Show movie details modal
                    this.showMovieModal(movieData);
                } catch (error) {
                    this.showNotification('Failed to load movie details', 'error');
                }
            }

            showMovieModal(movie) {
                const modal = document.getElementById('movie-modal');
                const title = document.getElementById('modal-movie-title');
                const poster = document.getElementById('modal-movie-poster');
                const meta = document.getElementById('modal-movie-meta');
                const description = document.getElementById('modal-movie-description');

                // Set movie title
                title.textContent = movie.title;

                // Set movie poster
                poster.src = `${this.IMG_BASE_URL}${movie.poster_path}`;
                poster.alt = movie.title;

                // Set movie meta information
                const releaseYear = movie.release_date ? new Date(movie.release_date).getFullYear() : 'N/A';
                const runtime = movie.runtime ? `${movie.runtime} min` : 'N/A';
                const rating = movie.vote_average ? movie.vote_average.toFixed(1) : 'N/A';
                const genres = movie.genres ? movie.genres.map(g => g.name).join(', ') : 'N/A';

                meta.innerHTML = `
                    <span class="meta-item"><i class="fas fa-calendar"></i> ${releaseYear}</span>
                    <span class="meta-item"><i class="fas fa-clock"></i> ${runtime}</span>
                    <span class="meta-item"><i class="fas fa-star"></i> ${rating}</span>
                    <span class="meta-item"><i class="fas fa-tags"></i> ${genres}</span>
                `;

                // Set movie description
                description.textContent = movie.overview || 'No description available for this movie.';

                // Show modal
                modal.classList.add('show');
            }

            showWatchOptions() {
                // Hide movie details modal
                document.getElementById('movie-modal').classList.remove('show');
                
                // Show watch options modal
                document.getElementById('watch-options-modal').classList.add('show');
            }

            watchOnTubi() {
                if (this.currentMovie) {
                    // Create netflix search URL
                    const tubiUrl = `https://netflix.com/search/${encodeURIComponent(this.currentMovie.title)}`;
                    window.open(tubiUrl, '_blank');
                    this.closeAllModals();
                    this.showNotification('Redirecting to Tubi.com...', 'success');
                }
            }

            watchInWeb() {
                if (this.currentMovie) {
                    // Create a movie player page URL (you can customize this)
                    const playerUrl = `watch.html?id=${this.currentMovie.id}&title=${encodeURIComponent(this.currentMovie.title)}`;
                    
                    // Store movie data for the player page
                    localStorage.setItem('selectedMovie', JSON.stringify({
                        id: this.currentMovie.id,
                        title: this.currentMovie.title,
                        poster: this.currentMovie.poster_path,
                        overview: this.currentMovie.overview,
                        timestamp: Date.now()
                    }));

                    // Redirect to player page (you can create this page)
                    window.location.href = playerUrl;
                }
            }

            closeAllModals() {
                document.getElementById('movie-modal').classList.remove('show');
                document.getElementById('watch-options-modal').classList.remove('show');
            }

            showLoading() {
                document.getElementById('loading-container').style.display = 'flex';
            }

            hideLoading() {
                document.getElementById('loading-container').style.display = 'none';
            }

            clearMovies() {
                document.getElementById('movie-grid').innerHTML = '';
                this.currentPage = 1;
            }

            showNoResults() {
                const movieGrid = document.getElementById('movie-grid');
                movieGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 50px;">
                        <i class="fas fa-search" style="font-size: 60px; color: var(--text-secondary); margin-bottom: 20px;"></i>
                        <h3 style="color: var(--text-secondary); margin-bottom: 10px;">No movies found</h3>
                        <p style="color: var(--text-secondary);">Try searching with different keywords</p>
                    </div>
                `;
            }

            handleError(error, message) {
                console.error('CinemaVerse Error:', error);
                this.showError(message);
                this.hideLoading();
            }

            showError(message) {
                document.getElementById('error-message').textContent = message;
                document.getElementById('error-overlay').style.display = 'flex';
            }

            hideError() {
                document.getElementById('error-overlay').style.display = 'none';
            }

            showCacheStatus(message, type = 'success') {
                const indicator = document.getElementById('cache-indicator');
                indicator.innerHTML = `<i class="fas fa-check"></i> ${message}`;
                indicator.className = `cache-indicator ${type}`;
                indicator.classList.add('show');
                
                setTimeout(() => {
                    indicator.classList.remove('show');
                }, 3000);
            }

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 100px;
                    right: 20px;
                    background: ${type === 'error' ? 'var(--error-color)' : type === 'warning' ? 'var(--warning-color)' : 'var(--success-color)'};
                    color: white;
                    padding: 15px 20px;
                    border-radius: var(--border-radius);
                    z-index: 10000;
                    animation: slideIn 0.3s ease;
                    font-family: 'Orbitron', sans-serif;
                `;
                notification.textContent = message;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.remove();
                }, 4000);
            }
        }

        // Global function to close modals
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // Initialize the application
        const cinemaApp = new CinemaVerseApp();

        // Security measures
        document.addEventListener("keydown", function(e) {
            if ((e.key === 'F12') || 
                (e.ctrlKey && (e.key === 'u' || e.key === 'U')) || 
                (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'i'))) {
                e.preventDefault();
            }
        });

        document.addEventListener('contextmenu', e => e.preventDefault());

        // Detect DevTools
        let devtoolsOpen = false;
        setInterval(function() {
            const width = window.outerWidth - window.innerWidth > 100;
            const height = window.outerHeight - window.innerHeight > 100;
            if ((width || height) && !devtoolsOpen) {
                devtoolsOpen = true;
            }
            if (!(width || height) && devtoolsOpen) {
                devtoolsOpen = false;
            }
        }, 1000);
    </script>
</body>
</html>