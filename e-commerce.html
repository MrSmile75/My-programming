<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Trading Hub - Advanced E-commerce Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #3b82f6;
            --secondary: #10b981;
            --accent: #f59e0b;
            --danger: #ef4444;
            --success: #22c55e;
            --warning: #f59e0b;
            --info: #06b6d4;
            --dark: #0f172a;
            --dark-light: #1e293b;
            --dark-lighter: #334155;
            --light: #f8fafc;
            --gold: #fbbf24;
            --purple: #8b5cf6;
            --pink: #ec4899;
            --neon-blue: #00d4ff;
            --neon-green: #00ff88;
            --neon-purple: #b300ff;
            --gradient-1: linear-gradient(135deg, var(--primary), var(--secondary));
            --gradient-2: linear-gradient(135deg, var(--gold), var(--accent));
            --gradient-3: linear-gradient(135deg, var(--purple), var(--pink));
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--dark) 0%, var(--dark-light) 50%, var(--dark-lighter) 100%);
            color: var(--light);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .orbitron { font-family: 'Orbitron', monospace; }

        /* Enhanced Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.05); border-radius: 4px; }
        ::-webkit-scrollbar-thumb { 
            background: var(--gradient-2); 
            border-radius: 4px; 
            transition: all 0.3s ease;
        }
        ::-webkit-scrollbar-thumb:hover { background: var(--gradient-1); }

        /* Navigation */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
            padding: 1rem 0;
            box-shadow: var(--shadow-xl);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            font-weight: 900;
            background: var(--gradient-2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-link {
            color: var(--light);
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            transition: all 0.3s ease;
            position: relative;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(255, 255, 255, 0.1);
            color: var(--gold);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .search-bar {
            position: relative;
            width: 400px;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 3rem;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 2rem;
            color: white;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.2);
            background: rgba(30, 41, 59, 0.95);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
            font-size: 1.1rem;
        }

        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(15, 23, 42, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            margin-top: 0.5rem;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1001;
            display: none;
            box-shadow: var(--shadow-xl);
        }

        .search-suggestion {
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: background 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .search-suggestion:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .online-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid var(--success);
            border-radius: 2rem;
            font-size: 0.875rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .cart-btn {
            position: relative;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.75rem;
            border-radius: 0.75rem;
            transition: all 0.3s ease;
        }

        .cart-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--gold);
            color: black;
            border-radius: 50%;
            min-width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            animation: bounce 0.5s ease;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        /* Main Content */
        .main-content {
            padding-top: 100px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Hero Section */
        .hero {
            padding: 4rem 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(251, 191, 36, 0.05) 0%, transparent 70%);
            animation: heroRotate 30s linear infinite;
        }

        @keyframes heroRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hero-content {
            position: relative;
            z-index: 1;
        }

        .hero-title {
            font-family: 'Orbitron', monospace;
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 900;
            margin-bottom: 2rem;
            background: var(--gradient-2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(251, 191, 36, 0.3);
        }

        .hero-subtitle {
            font-size: 1.25rem;
            color: #94a3b8;
            margin-bottom: 3rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-actions {
            display: flex;
            gap: 2rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 4rem;
        }

        .hero-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .hero-stat {
            text-align: center;
            padding: 2rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .hero-stat:hover {
            transform: translateY(-5px);
            border-color: var(--gold);
            box-shadow: var(--shadow-xl);
        }

        .hero-stat-number {
            font-family: 'Orbitron', monospace;
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--gold);
            display: block;
            margin-bottom: 0.5rem;
        }

        .hero-stat-label {
            font-size: 0.875rem;
            color: #9ca3af;
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-family: inherit;
            position: relative;
            overflow: hidden;
            font-size: 0.9rem;
        }

        .btn:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover:before { left: 100%; }

        .btn-primary {
            background: var(--gradient-1);
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .btn-secondary {
            background: var(--gradient-2);
            color: black;
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--gold);
            color: var(--gold);
        }

        .btn-outline:hover {
            background: var(--gold);
            color: black;
            transform: translateY(-2px);
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
        }

        .btn-lg {
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
        }

        /* Cards */
        .card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 2rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-2);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
            border-color: var(--gold);
        }

        .card:hover:before { opacity: 1; }

        /* Product Grid */
        .products-section {
            padding: 4rem 0;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
        }

        .section-title {
            font-family: 'Orbitron', monospace;
            font-size: 2rem;
            font-weight: bold;
            background: var(--gradient-2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .filters-container {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 2rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }

        .filter-btn:hover, .filter-btn.active {
            background: var(--gold);
            color: black;
            border-color: var(--gold);
            transform: translateY(-2px);
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .product-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
            border-color: var(--gold);
        }

        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-content {
            padding: 1.5rem;
        }

        .product-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: white;
        }

        .product-description {
            color: #94a3b8;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-size: 0.9rem;
        }

        .product-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .product-price {
            font-size: 1.25rem;
            font-weight: bold;
            color: var(--gold);
        }

        .product-category {
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            background: rgba(59, 130, 246, 0.2);
            color: #93c5fd;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .product-seller {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.875rem;
            color: #9ca3af;
        }

        .seller-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--gold);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            color: black;
        }

        .product-actions {
            display: flex;
            gap: 0.5rem;
        }

        .product-actions .btn {
            flex: 1;
            justify-content: center;
        }

        .online-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(34, 197, 94, 0.9);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .business-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            backdrop-filter: blur(10px);
        }

        /* Load More */
        .load-more-container {
            text-align: center;
            margin: 3rem 0;
        }

        .load-more-btn {
            padding: 1rem 3rem;
            background: var(--gradient-1);
            color: white;
            border: none;
            border-radius: 2rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .load-more-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .load-more-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(15px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: rgba(15, 23, 42, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 2rem;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow-xl);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
        }

        .modal-close {
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: rotate(90deg);
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: white;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            color: white;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.2);
            background: rgba(30, 41, 59, 0.95);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Image Upload Styles */
        .image-upload-container {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 0.5rem;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .image-upload-container:hover {
            border-color: var(--gold);
            background: rgba(251, 191, 36, 0.05);
        }

        .image-upload-container.dragover {
            border-color: var(--gold);
            background: rgba(251, 191, 36, 0.1);
        }

        .image-preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .image-preview-item {
            position: relative;
            border-radius: 0.5rem;
            overflow: hidden;
            aspect-ratio: 1;
        }

        .image-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-preview-remove {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 0.75rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .image-preview-remove:hover {
            background: #ef4444;
            transform: scale(1.1);
        }

        /* Notifications */
        .notification-container {
            position: fixed;
            top: 120px;
            right: 20px;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-width: 400px;
        }

        .notification {
            background: rgba(15, 23, 42, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            padding: 1rem 1.5rem;
            min-width: 300px;
            transform: translateX(100%);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: var(--shadow-xl);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success { border-left: 4px solid var(--success); }
        .notification.error { border-left: 4px solid var(--danger); }
        .notification.warning { border-left: 4px solid var(--warning); }
        .notification.info { border-left: 4px solid var(--info); }

        /* Loading */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 4000;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--gold);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Real-time Updates */
        .update-indicator {
            position: fixed;
            top: 120px;
            left: 20px;
            background: rgba(34, 197, 94, 0.95);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            font-weight: 600;
            z-index: 1000;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .update-indicator.show {
            transform: translateX(0);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-container {
                padding: 0 1rem;
                flex-wrap: wrap;
                gap: 1rem;
            }

            .nav-menu {
                display: none;
            }

            .search-bar {
                width: 100%;
                order: 3;
                flex-basis: 100%;
            }

            .hero-title {
                font-size: 2.5rem;
            }

            .hero-actions {
                flex-direction: column;
                align-items: center;
            }

            .products-grid {
                grid-template-columns: 1fr;
            }

            .section-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }

            .filters-container {
                justify-content: center;
            }

            .modal-content {
                margin: 1rem;
                padding: 1rem;
            }
        }

        /* Utility Classes */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .gap-1 { gap: 0.25rem; }
        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 0.75rem; }
        .gap-4 { gap: 1rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mt-4 { margin-top: 1rem; }
        .p-4 { padding: 1rem; }
        .text-sm { font-size: 0.875rem; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }
        .font-bold { font-weight: bold; }
        .font-semibold { font-weight: 600; }

        /* Advanced Features */
        .floating-action-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: var(--gradient-2);
            border: none;
            border-radius: 50%;
            color: black;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-xl);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .floating-action-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 20px 40px rgba(251, 191, 36, 0.3);
        }

        .quick-actions {
            position: fixed;
            bottom: 5rem;
            right: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            z-index: 999;
        }

        .quick-actions.show {
            opacity: 1;
            transform: translateY(0);
        }

        .quick-action-btn {
            width: 50px;
            height: 50px;
            background: rgba(30, 41, 59, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .quick-action-btn:hover {
            background: var(--gold);
            color: black;
            transform: scale(1.1);
        }

        /* Advanced Search */
        .advanced-search {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            display: none;
        }

        .advanced-search.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .search-filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        /* Infinite Scroll Indicator */
        .infinite-scroll-indicator {
            text-align: center;
            padding: 2rem;
            color: #9ca3af;
        }

        .infinite-scroll-indicator.loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

        /* Product Categories */
        .category-electronics { background: rgba(59, 130, 246, 0.2); color: #93c5fd; border-color: rgba(59, 130, 246, 0.3); }
        .category-fashion { background: rgba(236, 72, 153, 0.2); color: #f9a8d4; border-color: rgba(236, 72, 153, 0.3); }
        .category-home { background: rgba(34, 197, 94, 0.2); color: #86efac; border-color: rgba(34, 197, 94, 0.3); }
        .category-sports { background: rgba(245, 158, 11, 0.2); color: #fbbf24; border-color: rgba(245, 158, 11, 0.3); }
        .category-books { background: rgba(168, 85, 247, 0.2); color: #c4b5fd; border-color: rgba(168, 85, 247, 0.3); }
        .category-automotive { background: rgba(239, 68, 68, 0.2); color: #fca5a5; border-color: rgba(239, 68, 68, 0.3); }
        .category-beauty { background: rgba(236, 72, 153, 0.2); color: #f9a8d4; border-color: rgba(236, 72, 153, 0.3); }
        .category-toys { background: rgba(168, 85, 247, 0.2); color: #c4b5fd; border-color: rgba(168, 85, 247, 0.3); }
        .category-music { background: rgba(6, 182, 212, 0.2); color: #67e8f9; border-color: rgba(6, 182, 212, 0.3); }
        .category-food { background: rgba(34, 197, 94, 0.2); color: #86efac; border-color: rgba(34, 197, 94, 0.3); }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">ðŸš€ GLOBAL TRADING HUB</div>
            
            <div class="search-bar">
                <i class="bi bi-search search-icon"></i>
                <input type="text" id="globalSearch" class="search-input" placeholder="Search anything worldwide..." autocomplete="off">
                <div id="searchSuggestions" class="search-suggestions"></div>
            </div>
            
            <ul class="nav-menu">
                <li><a href="#" class="nav-link active" onclick="showSection('home')"><i class="bi bi-house-door"></i> Home</a></li>
                <li><a href="#" class="nav-link" onclick="showSection('marketplace')"><i class="bi bi-shop"></i> Marketplace</a></li>
                <li><a href="#" class="nav-link" onclick="showSection('sell')"><i class="bi bi-tag"></i> Sell</a></li>
                <li><a href="#" class="nav-link" onclick="showSection('analytics')"><i class="bi bi-graph-up"></i> Analytics</a></li>
            </ul>
            
            <div class="nav-actions">
                <div class="online-indicator">
                    <div class="status-dot"></div>
                    <span id="onlineCount">1,247</span> Online Moderators
                </div>
                
                <button class="cart-btn" onclick="openCart()">
                    <i class="bi bi-cart3"></i>
                    <span id="cartCount" class="cart-count">0</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Section -->
        <section id="homeSection" class="hero">
            <div class="hero-content">
                <div class="container">
                    <h1 class="hero-title">INFINITE MARKETPLACE</h1>
                    <p class="hero-subtitle">
                        Connect with millions of sellers worldwide. Real-time updates, infinite storage, and instant global search. 
                        Experience the future of e-commerce with unlimited possibilities.
                    </p>
                    
                    <div class="hero-actions">
                        <button class="btn btn-primary btn-lg" onclick="showSection('marketplace')">
                            <i class="bi bi-shop"></i> Explore Marketplace
                        </button>
                        <button class="btn btn-secondary btn-lg" onclick="showSection('sell')">
                            <i class="bi bi-plus-circle"></i> Start Selling
                        </button>
                        <button class="btn btn-outline btn-lg" onclick="startLiveDemo()">
                            <i class="bi bi-play-circle"></i> Live Demo
                        </button>
                    </div>
                    
                    <div class="hero-stats">
                        <div class="hero-stat">
                            <span class="hero-stat-number" id="totalProducts">0</span>
                            <div class="hero-stat-label">Products Available</div>
                        </div>
                        <div class="hero-stat">
                            <span class="hero-stat-number" id="activeSellers">0</span>
                            <div class="hero-stat-label">Active Sellers</div>
                        </div>
                        <div class="hero-stat">
                            <span class="hero-stat-number" id="countriesServed">195</span>
                            <div class="hero-stat-label">Countries Served</div>
                        </div>
                        <div class="hero-stat">
                            <span class="hero-stat-number">24/7</span>
                            <div class="hero-stat-label">Real-time Updates</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Marketplace Section -->
        <section id="marketplaceSection" class="products-section hidden">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Global Marketplace</h2>
                    <div class="filters-container">
                        <button class="filter-btn active" onclick="filterProducts('all')">All</button>
                        <button class="filter-btn" onclick="filterProducts('electronics')">Electronics</button>
                        <button class="filter-btn" onclick="filterProducts('fashion')">Fashion</button>
                        <button class="filter-btn" onclick="filterProducts('home')">Home</button>
                        <button class="filter-btn" onclick="filterProducts('sports')">Sports</button>
                        <button class="filter-btn" onclick="filterProducts('books')">Books</button>
                        <button class="filter-btn" onclick="filterProducts('automotive')">Automotive</button>
                        <button class="filter-btn" onclick="filterProducts('beauty')">Beauty</button>
                        <button class="filter-btn" onclick="filterProducts('toys')">Toys</button>
                        <button class="filter-btn" onclick="filterProducts('music')">Music</button>
                        <button class="filter-btn" onclick="filterProducts('food')">Food</button>
                        <button class="btn btn-outline btn-sm" onclick="toggleAdvancedSearch()">
                            <i class="bi bi-funnel"></i> Advanced Search
                        </button>
                    </div>
                </div>

                <!-- Advanced Search -->
                <div id="advancedSearch" class="advanced-search">
                    <h3 class="mb-4">Advanced Search Filters</h3>
                    <div class="search-filters">
                        <div class="form-group">
                            <label class="form-label">Price Range</label>
                            <div class="flex gap-2">
                                <input type="number" id="minPrice" class="form-input" placeholder="Min">
                                <input type="number" id="maxPrice" class="form-input" placeholder="Max">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Location</label>
                            <select id="locationFilter" class="form-select">
                                <option value="">All Locations</option>
                                <option value="US">United States</option>
                                <option value="CA">Canada</option>
                                <option value="UK">United Kingdom</option>
                                <option value="DE">Germany</option>
                                <option value="FR">France</option>
                                <option value="JP">Japan</option>
                                <option value="AU">Australia</option>
                                <option value="GH">Ghana</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Condition</label>
                            <select id="conditionFilter" class="form-select">
                                <option value="">All Conditions</option>
                                <option value="new">New</option>
                                <option value="like-new">Like New</option>
                                <option value="good">Good</option>
                                <option value="fair">Fair</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Sort By</label>
                            <select id="sortBy" class="form-select">
                                <option value="newest">Newest First</option>
                                <option value="price-low">Price: Low to High</option>
                                <option value="price-high">Price: High to Low</option>
                                <option value="popular">Most Popular</option>
                                <option value="rating">Highest Rated</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button class="btn btn-primary" onclick="applyAdvancedFilters()">Apply Filters</button>
                        <button class="btn btn-outline" onclick="clearAllFilters()">Clear All</button>
                    </div>
                </div>

                <!-- Products Grid -->
                <div id="productsGrid" class="products-grid">
                    <!-- Products will be loaded here -->
                </div>

                <!-- Infinite Scroll Indicator -->
                <div id="infiniteScrollIndicator" class="infinite-scroll-indicator">
                    <div class="loading hidden">
                        <div class="loading-spinner"></div>
                        <span>Loading more products...</span>
                    </div>
                </div>

                <!-- Load More Button -->
                <div class="load-more-container">
                    <button id="loadMoreBtn" class="load-more-btn" onclick="loadMoreProducts()">
                        <i class="bi bi-arrow-down-circle"></i> Load More Products
                    </button>
                </div>
            </div>
        </section>

        <!-- Sell Section -->
        <section id="sellSection" class="products-section hidden">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">List Your Products</h2>
                    <div class="flex gap-2">
                        <button class="btn btn-outline" onclick="saveDraft()">
                            <i class="bi bi-save"></i> Save Draft
                        </button>
                        <button class="btn btn-secondary" onclick="loadDraft()">
                            <i class="bi bi-upload"></i> Load Draft
                        </button>
                    </div>
                </div>

                <div class="card">
                    <form id="sellForm">
                        <div class="form-group">
                            <label class="form-label">
                                <i class="bi bi-building"></i> Business Name
                            </label>
                            <input type="text" id="businessName" class="form-input" placeholder="Enter your business name" required>
                        </div>

                        <div class="flex gap-4">
                            <div class="form-group" style="flex: 1;">
                                <label class="form-label">
                                    <i class="bi bi-tag"></i> Product Name
                                </label>
                                <input type="text" name="productName" class="form-input" placeholder="Enter product name" required>
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label class="form-label">
                                    <i class="bi bi-grid"></i> Category
                                </label>
                                <select name="category" class="form-select" required>
                                    <option value="">Select Category</option>
                                    <option value="electronics">Electronics</option>
                                    <option value="fashion">Fashion</option>
                                    <option value="home">Home & Garden</option>
                                    <option value="sports">Sports</option>
                                    <option value="books">Books</option>
                                    <option value="automotive">Automotive</option>
                                    <option value="beauty">Beauty</option>
                                    <option value="toys">Toys</option>
                                    <option value="music">Music</option>
                                    <option value="food">Food</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="bi bi-card-text"></i> Description
                            </label>
                            <textarea name="description" class="form-textarea" placeholder="Describe your product in detail..." required></textarea>
                        </div>

                        <div class="flex gap-4">
                            <div class="form-group" style="flex: 1;">
                                <label class="form-label">
                                    <i class="bi bi-currency-dollar"></i> Price
                                </label>
                                <input type="number" name="price" step="0.01" class="form-input" placeholder="0.00" required>
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label class="form-label">
                                    <i class="bi bi-star"></i> Condition
                                </label>
                                <select name="condition" class="form-select" required>
                                    <option value="new">New</option>
                                    <option value="like-new">Like New</option>
                                    <option value="good">Good</option>
                                    <option value="fair">Fair</option>
                                </select>
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label class="form-label">
                                    <i class="bi bi-box"></i> Quantity
                                </label>
                                <input type="number" name="quantity" class="form-input" min="1" value="1" required>
                            </div>
                        </div>

                        <div class="flex gap-4">
                            <div class="form-group" style="flex: 1;">
                                <label class="form-label">
                                    <i class="bi bi-geo-alt"></i> Location
                                </label>
                                <select name="location" class="form-select" required>
                                    <option value="">Select Location</option>
                                    <option value="US">United States</option>
                                    <option value="CA">Canada</option>
                                    <option value="UK">United Kingdom</option>
                                    <option value="DE">Germany</option>
                                    <option value="FR">France</option>
                                    <option value="JP">Japan</option>
                                    <option value="AU">Australia</option>
                                    <option value="GH">Ghana</option>
                                </select>
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label class="form-label">
                                    <i class="bi bi-telephone"></i> Contact Number
                                </label>
                                <input type="tel" name="phone" class="form-input" placeholder="+1 (555) 123-4567" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="bi bi-images"></i> Product Images (Required)
                            </label>
                            <div class="image-upload-container" onclick="document.getElementById('productImages').click()">
                                <i class="bi bi-cloud-upload" style="font-size: 3rem; color: var(--gold); margin-bottom: 1rem;"></i>
                                <h3>Upload Product Images</h3>
                                <p style="color: #9ca3af; margin-bottom: 1rem;">Click here or drag and drop images</p>
                                <p style="font-size: 0.875rem; color: #6b7280;">Supports: JPG, PNG, GIF (Max 5MB each)</p>
                            </div>
                            <input type="file" id="productImages" name="images" accept="image/*" multiple class="hidden" required>
                            <div id="imagePreview" class="image-preview-grid hidden"></div>
                        </div>

                        <div class="flex gap-3">
                            <button type="submit" class="btn btn-primary" style="flex: 1;">
                                <i class="bi bi-upload"></i> List Product
                            </button>
                            <button type="button" class="btn btn-outline" onclick="previewProduct()">
                                <i class="bi bi-eye"></i> Preview
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="analyticsSection" class="products-section hidden">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Analytics Dashboard</h2>
                    <div class="flex gap-2">
                        <button class="btn btn-outline" onclick="exportAnalytics()">
                            <i class="bi bi-download"></i> Export Data
                        </button>
                        <button class="btn btn-secondary" onclick="refreshAnalytics()">
                            <i class="bi bi-arrow-clockwise"></i> Refresh
                        </button>
                    </div>
                </div>

                <div class="hero-stats mb-4">
                    <div class="hero-stat">
                        <span class="hero-stat-number" id="totalListings">0</span>
                        <div class="hero-stat-label">Your Listings</div>
                    </div>
                    <div class="hero-stat">
                        <span class="hero-stat-number" id="totalViews">0</span>
                        <div class="hero-stat-label">Total Views</div>
                    </div>
                    <div class="hero-stat">
                        <span class="hero-stat-number" id="totalSales">0</span>
                        <div class="hero-stat-label">Total Sales</div>
                    </div>
                    <div class="hero-stat">
                        <span class="hero-stat-number" id="totalRevenue">$0</span>
                        <div class="hero-stat-label">Revenue</div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="mb-4">Your Products</h3>
                    <div id="userProducts" class="products-grid">
                        <!-- User products will be loaded here -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Floating Action Button -->
    <button class="floating-action-btn" onclick="toggleQuickActions()">
        <i class="bi bi-plus" id="fabIcon"></i>
    </button>

    <!-- Quick Actions -->
    <div id="quickActions" class="quick-actions">
        <button class="quick-action-btn" onclick="showSection('sell')" title="Sell Product">
            <i class="bi bi-tag"></i>
        </button>
        <button class="quick-action-btn" onclick="openCart()" title="View Cart">
            <i class="bi bi-cart"></i>
        </button>
        <button class="quick-action-btn" onclick="scrollToTop()" title="Scroll to Top">
            <i class="bi bi-arrow-up"></i>
        </button>
        <button class="quick-action-btn" onclick="toggleTheme()" title="Toggle Theme">
            <i class="bi bi-moon"></i>
        </button>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="modal">
        <div class="modal-content" style="width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="bi bi-cart3"></i> Shopping Cart
                    <span class="text-sm font-normal ml-2">(<span id="cartItemCount">0</span> items)</span>
                </h3>
                <button class="modal-close" onclick="closeCart()">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            
            <div id="cartItems" class="mb-4" style="max-height: 400px; overflow-y: auto;">
                <!-- Cart items will be loaded here -->
            </div>
            
            <div class="flex justify-between items-center p-4" style="border-top: 1px solid rgba(255,255,255,0.1);">
                <div class="flex items-center gap-4">
                    <span class="text-lg font-bold">Total:</span>
                    <span id="cartTotal" class="text-xl font-bold" style="color: var(--gold);">$0.00</span>
                </div>
            </div>
            
            <div class="flex gap-3">
                <button class="btn btn-outline" style="flex: 1;" onclick="closeCart()">
                    <i class="bi bi-arrow-left"></i> Continue Shopping
                </button>
                <button class="btn btn-primary" style="flex: 1;" onclick="checkout()">
                    <i class="bi bi-credit-card"></i> Checkout
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Real-time Update Indicator -->
    <div id="updateIndicator" class="update-indicator">
        <i class="bi bi-arrow-clockwise"></i>
        <span>New products available!</span>
    </div>

    <script>
        // Global Variables
        let currentUser = {
            id: localStorage.getItem('userId') || 'user_' + Date.now(),
            name: localStorage.getItem('userName') || 'Anonymous User',
            businessName: localStorage.getItem('businessName') || '',
            location: localStorage.getItem('userLocation') || 'Global',
            isOnline: true
        };

        let allProducts = JSON.parse(localStorage.getItem('allProducts')) || [];
        let displayedProducts = [];
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let currentPage = 1;
        let productsPerPage = 12;
        let isLoading = false;
        let hasMoreProducts = true;
        let currentFilters = {
            category: 'all',
            minPrice: null,
            maxPrice: null,
            location: '',
            condition: '',
            sortBy: 'newest',
            searchQuery: ''
        };

        // Sample product categories and data
        const categories = [
            'electronics', 'fashion', 'home', 'sports', 'books', 
            'automotive', 'beauty', 'toys', 'music', 'food'
        ];

        const locations = [
            { code: 'US', name: 'United States', flag: 'ðŸ‡ºðŸ‡¸' },
            { code: 'CA', name: 'Canada', flag: 'ðŸ‡¨ðŸ‡¦' },
            { code: 'UK', name: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
            { code: 'DE', name: 'Germany', flag: 'ðŸ‡©ðŸ‡ª' },
            { code: 'FR', name: 'France', flag: 'ðŸ‡«ðŸ‡·' },
            { code: 'JP', name: 'Japan', flag: 'ðŸ‡¯ðŸ‡µ' },
            { code: 'AU', name: 'Australia', flag: 'ðŸ‡¦ðŸ‡º' },
            { code: 'GH', name: 'Ghana', flag: 'ðŸ‡¬ðŸ‡­' }
        ];

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            console.log('ðŸš€ Initializing Advanced E-commerce Platform...');
            
            // Store user ID
            localStorage.setItem('userId', currentUser.id);
            
            // Setup event listeners
            setupEventListeners();
            
            // Load products from localStorage or create initial empty state
            if (allProducts.length === 0) {
                showEmptyMarketplaceMessage();
            } else {
                loadProducts();
            }
            
            // Update cart UI
            updateCartUI();
            
            // Update stats
            updateStats();
            
            console.log('âœ… Platform initialized successfully!');
            showNotification('Welcome to Global Trading Hub! ðŸš€ Start by listing your first product!', 'success');
        }

        function setupEventListeners() {
            // Global search
            const searchInput = document.getElementById('globalSearch');
            searchInput.addEventListener('input', handleGlobalSearch);
            searchInput.addEventListener('focus', showSearchSuggestions);
            searchInput.addEventListener('blur', hideSearchSuggestions);

            // Sell form
            document.getElementById('sellForm').addEventListener('submit', handleSellForm);
            
            // Image upload
            document.getElementById('productImages').addEventListener('change', handleImageUpload);
            
            // Drag and drop for image upload
            const uploadContainer = document.querySelector('.image-upload-container');
            uploadContainer.addEventListener('dragover', handleDragOver);
            uploadContainer.addEventListener('dragleave', handleDragLeave);
            uploadContainer.addEventListener('drop', handleDrop);
            
            // Advanced filters
            document.getElementById('minPrice').addEventListener('input', debounce(applyAdvancedFilters, 500));
            document.getElementById('maxPrice').addEventListener('input', debounce(applyAdvancedFilters, 500));
            document.getElementById('locationFilter').addEventListener('change', applyAdvancedFilters);
            document.getElementById('conditionFilter').addEventListener('change', applyAdvancedFilters);
            document.getElementById('sortBy').addEventListener('change', applyAdvancedFilters);

            // Keyboard shortcuts
            document.addEventListener('keydown', handleKeyboardShortcuts);
            
            // Window events
            window.addEventListener('scroll', handleScroll);
            window.addEventListener('resize', handleResize);
            window.addEventListener('online', () => showNotification('Connection restored! ðŸŒ', 'success'));
            window.addEventListener('offline', () => showNotification('Working offline... ðŸ“±', 'warning'));
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            
            const files = Array.from(e.dataTransfer.files);
            const imageFiles = files.filter(file => file.type.startsWith('image/'));
            
            if (imageFiles.length > 0) {
                const input = document.getElementById('productImages');
                const dt = new DataTransfer();
                imageFiles.forEach(file => dt.items.add(file));
                input.files = dt.files;
                handleImageUpload({ target: input });
            }
        }

        function handleGlobalSearch(e) {
            const query = e.target.value.toLowerCase();
            currentFilters.searchQuery = query;
            
            if (query.length > 0) {
                showSearchSuggestions();
                generateSearchSuggestions(query);
            } else {
                hideSearchSuggestions();
            }
            
            debounce(loadProducts, 300)();
        }

        function generateSearchSuggestions(query) {
            const suggestions = document.getElementById('searchSuggestions');
            const matchingProducts = allProducts.filter(product => 
                product.name.toLowerCase().includes(query) ||
                product.description.toLowerCase().includes(query) ||
                product.category.toLowerCase().includes(query) ||
                product.businessName.toLowerCase().includes(query)
            ).slice(0, 5);

            const categoryMatches = categories.filter(cat => 
                cat.toLowerCase().includes(query)
            ).slice(0, 3);

            suggestions.innerHTML = '';

            // Add product suggestions
            matchingProducts.forEach(product => {
                const suggestion = document.createElement('div');
                suggestion.className = 'search-suggestion';
                suggestion.innerHTML = `
                    <i class="bi bi-box"></i>
                    <div>
                        <div style="font-weight: 600;">${product.name}</div>
                        <div style="font-size: 0.8rem; color: #9ca3af;">${product.businessName} â€¢ $${product.price}</div>
                    </div>
                `;
                suggestion.onclick = () => selectSearchSuggestion(product.name);
                suggestions.appendChild(suggestion);
            });

            // Add category suggestions
            categoryMatches.forEach(category => {
                const suggestion = document.createElement('div');
                suggestion.className = 'search-suggestion';
                suggestion.innerHTML = `
                    <i class="bi bi-grid"></i>
                    <div>
                        <div style="font-weight: 600;">${category.charAt(0).toUpperCase() + category.slice(1)}</div>
                        <div style="font-size: 0.8rem; color: #9ca3af;">Category</div>
                    </div>
                `;
                suggestion.onclick = () => {
                    filterProducts(category);
                    hideSearchSuggestions();
                };
                suggestions.appendChild(suggestion);
            });

            if (matchingProducts.length === 0 && categoryMatches.length === 0) {
                suggestions.innerHTML = `
                    <div class="search-suggestion">
                        <i class="bi bi-search"></i>
                        <div>No suggestions found for "${query}"</div>
                    </div>
                `;
            }
        }

        function selectSearchSuggestion(productName) {
            document.getElementById('globalSearch').value = productName;
            currentFilters.searchQuery = productName.toLowerCase();
            hideSearchSuggestions();
            loadProducts();
        }

        function showSearchSuggestions() {
            document.getElementById('searchSuggestions').style.display = 'block';
        }

        function hideSearchSuggestions() {
            setTimeout(() => {
                document.getElementById('searchSuggestions').style.display = 'none';
            }, 200);
        }

        function handleKeyboardShortcuts(e) {
            // Ctrl/Cmd + K for search
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                document.getElementById('globalSearch').focus();
            }
            
            // Escape to close modals
            if (e.key === 'Escape') {
                closeAllModals();
            }
        }

        function handleScroll() {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            // Show/hide floating action button
            const fab = document.querySelector('.floating-action-btn');
            if (scrollTop > 300) {
                fab.style.opacity = '1';
                fab.style.pointerEvents = 'auto';
            } else {
                fab.style.opacity = '0.7';
            }
        }

        function handleResize() {
            // Adjust grid columns based on screen size
            const grid = document.getElementById('productsGrid');
            const width = window.innerWidth;
            
            if (width < 768) {
                grid.style.gridTemplateColumns = '1fr';
            } else if (width < 1024) {
                grid.style.gridTemplateColumns = 'repeat(2, 1fr)';
            } else if (width < 1400) {
                grid.style.gridTemplateColumns = 'repeat(3, 1fr)';
            } else {
                grid.style.gridTemplateColumns = 'repeat(4, 1fr)';
            }
        }

        function showEmptyMarketplaceMessage() {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 4rem;">
                    <i class="bi bi-shop" style="font-size: 4rem; color: #6b7280; margin-bottom: 1rem;"></i>
                    <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">No products available yet</h3>
                    <p style="color: #9ca3af; margin-bottom: 2rem;">Be the first to list a product on our marketplace!</p>
                    <button class="btn btn-primary" onclick="showSection('sell')">
                        <i class="bi bi-plus"></i> List Your First Product
                    </button>
                </div>
            `;
        }

        function loadProducts() {
            if (isLoading) return;
            
            console.log('ðŸ”„ Loading products with filters:', currentFilters);
            
            if (allProducts.length === 0) {
                showEmptyMarketplaceMessage();
                updateLoadMoreButton();
                return;
            }
            
            let filteredProducts = [...allProducts];
            
            // Apply filters
            if (currentFilters.category !== 'all') {
                filteredProducts = filteredProducts.filter(p => p.category === currentFilters.category);
            }
            
            if (currentFilters.searchQuery) {
                const query = currentFilters.searchQuery.toLowerCase();
                filteredProducts = filteredProducts.filter(p => 
                    p.name.toLowerCase().includes(query) ||
                    p.description.toLowerCase().includes(query) ||
                    p.category.toLowerCase().includes(query) ||
                    p.businessName.toLowerCase().includes(query) ||
                    p.locationName.toLowerCase().includes(query)
                );
            }
            
            if (currentFilters.minPrice !== null) {
                filteredProducts = filteredProducts.filter(p => p.price >= currentFilters.minPrice);
            }
            
            if (currentFilters.maxPrice !== null) {
                filteredProducts = filteredProducts.filter(p => p.price <= currentFilters.maxPrice);
            }
            
            if (currentFilters.location) {
                filteredProducts = filteredProducts.filter(p => p.location === currentFilters.location);
            }
            
            if (currentFilters.condition) {
                filteredProducts = filteredProducts.filter(p => p.condition === currentFilters.condition);
            }
            
            // Sort products
            filteredProducts.sort((a, b) => {
                switch (currentFilters.sortBy) {
                    case 'price-low':
                        return a.price - b.price;
                    case 'price-high':
                        return b.price - a.price;
                    case 'popular':
                        return (b.views || 0) - (a.views || 0);
                    case 'rating':
                        return (b.rating || 0) - (a.rating || 0);
                    default:
                        return b.dateAdded - a.dateAdded;
                }
            });
            
            // Reset pagination
            currentPage = 1;
            displayedProducts = filteredProducts.slice(0, productsPerPage);
            hasMoreProducts = filteredProducts.length > productsPerPage;
            
            renderProducts();
            updateLoadMoreButton();
        }

        function loadMoreProducts() {
            if (isLoading || !hasMoreProducts) return;
            
            isLoading = true;
            showLoading(true);
            
            // Simulate loading delay
            setTimeout(() => {
                let filteredProducts = [...allProducts];
                
                // Apply same filters as loadProducts
                if (currentFilters.category !== 'all') {
                    filteredProducts = filteredProducts.filter(p => p.category === currentFilters.category);
                }
                
                if (currentFilters.searchQuery) {
                    const query = currentFilters.searchQuery.toLowerCase();
                    filteredProducts = filteredProducts.filter(p => 
                        p.name.toLowerCase().includes(query) ||
                        p.description.toLowerCase().includes(query) ||
                        p.category.toLowerCase().includes(query) ||
                        p.businessName.toLowerCase().includes(query) ||
                        p.locationName.toLowerCase().includes(query)
                    );
                }
                
                // Sort products
                filteredProducts.sort((a, b) => {
                    switch (currentFilters.sortBy) {
                        case 'price-low':
                            return a.price - b.price;
                        case 'price-high':
                            return b.price - a.price;
                        case 'popular':
                            return (b.views || 0) - (a.views || 0);
                        case 'rating':
                            return (b.rating || 0) - (a.rating || 0);
                        default:
                            return b.dateAdded - a.dateAdded;
                    }
                });
                
                currentPage++;
                const startIndex = (currentPage - 1) * productsPerPage;
                const endIndex = startIndex + productsPerPage;
                const newProducts = filteredProducts.slice(startIndex, endIndex);
                
                displayedProducts = [...displayedProducts, ...newProducts];
                hasMoreProducts = endIndex < filteredProducts.length;
                
                renderProducts();
                updateLoadMoreButton();
                
                isLoading = false;
                showLoading(false);
                
                showNotification(`Loaded ${newProducts.length} more products`, 'success');
            }, 1000);
        }

        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';
            
            if (displayedProducts.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 4rem;">
                        <i class="bi bi-search" style="font-size: 4rem; color: #6b7280; margin-bottom: 1rem;"></i>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">No products found</h3>
                        <p style="color: #9ca3af; margin-bottom: 2rem;">Try adjusting your search or filters</p>
                        <button class="btn btn-primary" onclick="clearAllFilters()">
                            <i class="bi bi-arrow-clockwise"></i> Clear Filters
                        </button>
                    </div>
                `;
                return;
            }
            
            displayedProducts.forEach(product => {
                const productCard = createProductCard(product);
                grid.appendChild(productCard);
            });
        }

        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card';
            
            const location = locations.find(l => l.code === product.location);
            const locationFlag = location ? location.flag : 'ðŸŒ';
            const locationName = location ? location.name : product.location;
            
            // Use the actual uploaded image or a placeholder
            const productImage = product.image || '/placeholder.svg?height=200&width=300';
            
            card.innerHTML = `
                ${product.isOnline ? `
                    <div class="online-badge">
                        <div class="status-dot"></div>
                        Online
                    </div>
                ` : ''}
                <div class="business-badge">${product.businessName}</div>
                
                <img src="${productImage}" alt="${product.name}" class="product-image" loading="lazy" onerror="this.src='/placeholder.svg?height=200&width=300'">
                
                <div class="product-content">
                    <h3 class="product-title">${product.name}</h3>
                    <p class="product-description">${product.description}</p>
                    
                    <div class="product-meta">
                        <span class="product-price">$${product.price.toFixed(2)}</span>
                        <span class="product-category category-${product.category}">${product.category}</span>
                    </div>
                    
                    <div class="product-seller">
                        <div class="seller-avatar">${product.businessName.charAt(0)}</div>
                        <div>
                            <div style="font-weight: 600;">${product.businessName}</div>
                            <div style="font-size: 0.8rem;">${locationFlag} ${locationName}</div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; font-size: 0.875rem; color: #9ca3af;">
                        <span>${product.condition}</span>
                        <span><i class="bi bi-eye"></i> ${product.views || 0}</span>
                        <span><i class="bi bi-star-fill"></i> ${product.rating || '5.0'}</span>
                        <span>Qty: ${product.quantity}</span>
                    </div>
                    
                    <div class="product-actions">
                        <button class="btn btn-primary btn-sm" onclick="addToCart('${product.id}')" ${product.quantity < 1 ? 'disabled' : ''}>
                            <i class="bi bi-cart-plus"></i> Add to Cart
                        </button>
                        <button class="btn btn-outline btn-sm" onclick="contactSeller('${product.id}')">
                            <i class="bi bi-chat-dots"></i> Contact
                        </button>
                    </div>
                    
                    <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                        <button class="btn btn-secondary btn-sm" onclick="viewProduct('${product.id}')" style="flex: 1;">
                            <i class="bi bi-eye"></i> View Details
                        </button>
                        <button class="btn btn-outline btn-sm" onclick="likeProduct('${product.id}')">
                            <i class="bi bi-heart"></i> ${product.likes || 0}
                        </button>
                    </div>
                </div>
            `;
            
            // Add click tracking
            card.addEventListener('click', (e) => {
                if (!e.target.closest('button')) {
                    trackProductView(product.id);
                }
            });
            
            return card;
        }

        function updateLoadMoreButton() {
            const btn = document.getElementById('loadMoreBtn');
            const indicator = document.getElementById('infiniteScrollIndicator');
            
            if (hasMoreProducts) {
                btn.style.display = 'block';
                btn.disabled = false;
                btn.innerHTML = '<i class="bi bi-arrow-down-circle"></i> Load More Products';
                indicator.querySelector('.loading').classList.add('hidden');
            } else {
                btn.style.display = 'none';
                if (allProducts.length > 0) {
                    indicator.innerHTML = '<div style="text-align: center; color: #9ca3af;">ðŸŽ‰ You\'ve seen all products! Check back later for new items.</div>';
                } else {
                    indicator.innerHTML = '';
                }
            }
        }

        function filterProducts(category) {
            currentFilters.category = category;
            
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            loadProducts();
            showNotification(`Filtered by: ${category === 'all' ? 'All Categories' : category}`, 'info');
        }

        function toggleAdvancedSearch() {
            const advancedSearch = document.getElementById('advancedSearch');
            advancedSearch.classList.toggle('show');
        }

        function applyAdvancedFilters() {
            currentFilters.minPrice = parseFloat(document.getElementById('minPrice').value) || null;
            currentFilters.maxPrice = parseFloat(document.getElementById('maxPrice').value) || null;
            currentFilters.location = document.getElementById('locationFilter').value;
            currentFilters.condition = document.getElementById('conditionFilter').value;
            currentFilters.sortBy = document.getElementById('sortBy').value;
            
            loadProducts();
            showNotification('Advanced filters applied', 'success');
        }

        function clearAllFilters() {
            currentFilters = {
                category: 'all',
                minPrice: null,
                maxPrice: null,
                location: '',
                condition: '',
                sortBy: 'newest',
                searchQuery: ''
            };
            
            // Reset UI
            document.getElementById('globalSearch').value = '';
            document.getElementById('minPrice').value = '';
            document.getElementById('maxPrice').value = '';
            document.getElementById('locationFilter').value = '';
            document.getElementById('conditionFilter').value = '';
            document.getElementById('sortBy').value = 'newest';
            
            // Reset filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.filter-btn').classList.add('active');
            
            loadProducts();
            showNotification('All filters cleared', 'info');
        }

        function addToCart(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) {
                showNotification('Product not found', 'error');
                return;
            }
            
            if (product.quantity < 1) {
                showNotification('Product is out of stock', 'error');
                return;
            }
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                if (existingItem.cartQuantity >= product.quantity) {
                    showNotification('Cannot add more items than available', 'warning');
                    return;
                }
                existingItem.cartQuantity += 1;
            } else {
                cart.push({
                    ...product,
                    cartQuantity: 1,
                    addedAt: Date.now()
                });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartUI();
            
            // Animate cart button
            const cartBtn = document.querySelector('.cart-btn');
            cartBtn.style.transform = 'scale(1.2)';
            setTimeout(() => {
                cartBtn.style.transform = 'scale(1)';
            }, 200);
            
            showNotification(`${product.name} added to cart!`, 'success');
        }

        function contactSeller(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) {
                showNotification('Product not found', 'error');
                return;
            }
            
            showNotification(`Contacting ${product.businessName}...`, 'info');
            
            // Simulate contact
            setTimeout(() => {
                showNotification(`Message sent to ${product.businessName}! They will respond shortly.`, 'success');
            }, 1500);
        }

        function viewProduct(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) {
                showNotification('Product not found', 'error');
                return;
            }
            
            trackProductView(productId);
            showNotification(`Viewing ${product.name}`, 'info');
        }

        function likeProduct(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;
            
            product.likes = (product.likes || 0) + 1;
            
            // Save to localStorage
            localStorage.setItem('allProducts', JSON.stringify(allProducts));
            
            // Update display
            loadProducts();
            
            showNotification('Product liked! â¤ï¸', 'success');
        }

        function trackProductView(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;
            
            product.views = (product.views || 0) + 1;
            
            // Save to localStorage
            localStorage.setItem('allProducts', JSON.stringify(allProducts));
        }

        function updateCartUI() {
            const cartCount = document.getElementById('cartCount');
            const cartItemCount = document.getElementById('cartItemCount');
            
            const totalItems = cart.reduce((sum, item) => sum + (item.cartQuantity || 1), 0);
            
            cartCount.textContent = totalItems;
            if (cartItemCount) {
                cartItemCount.textContent = totalItems;
            }
            
            // Update cart modal if open
            if (!document.getElementById('cartModal').classList.contains('hidden')) {
                updateCartModal();
            }
        }

        function updateCartModal() {
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            cartItems.innerHTML = '';
            
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div style="text-align: center; padding: 3rem;">
                        <i class="bi bi-cart-x" style="font-size: 4rem; color: #6b7280; margin-bottom: 1rem;"></i>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">Your cart is empty</h3>
                        <p style="color: #9ca3af; margin-bottom: 2rem;">Add some products to get started</p>
                        <button class="btn btn-primary" onclick="closeCart(); showSection('marketplace')">
                            <i class="bi bi-shop"></i> Browse Products
                        </button>
                    </div>
                `;
                cartTotal.textContent = '$0.00';
                return;
            }
            
            let total = 0;
            
            cart.forEach(item => {
                const itemTotal = item.price * (item.cartQuantity || 1);
                total += itemTotal;
                
                const cartItem = document.createElement('div');
                cartItem.className = 'flex justify-between items-center p-4';
                cartItem.style.borderBottom = '1px solid rgba(255,255,255,0.1)';
                
                cartItem.innerHTML = `
                    <div class="flex items-center gap-4">
                        <img src="${item.image || '/placeholder.svg?height=60&width=60'}" alt="${item.name}" style="width: 60px; height: 60px; object-fit: cover; border-radius: 0.5rem;">
                        <div style="flex: 1;">
                            <h4 style="font-weight: 600; margin-bottom: 0.25rem;">${item.name}</h4>
                            <p style="font-size: 0.875rem; color: #9ca3af;">${item.businessName}</p>
                            <p style="font-size: 0.875rem; color: var(--gold);">$${item.price.toFixed(2)} each</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="flex items-center gap-2">
                            <button class="btn btn-outline btn-sm" onclick="updateCartQuantity('${item.id}', ${(item.cartQuantity || 1) - 1})" ${(item.cartQuantity || 1) <= 1 ? 'disabled' : ''}>
                                <i class="bi bi-dash"></i>
                            </button>
                            <span style="width: 2rem; text-align: center; font-weight: bold;">${item.cartQuantity || 1}</span>
                            <button class="btn btn-outline btn-sm" onclick="updateCartQuantity('${item.id}', ${(item.cartQuantity || 1) + 1})">
                                <i class="bi bi-plus"></i>
                            </button>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: bold; color: var(--gold);">$${itemTotal.toFixed(2)}</div>
                            <button style="color: #ef4444; background: none; border: none; cursor: pointer; font-size: 0.875rem;" onclick="removeFromCart('${item.id}')">
                                <i class="bi bi-trash"></i> Remove
                            </button>
                        </div>
                    </div>
                `;
                
                cartItems.appendChild(cartItem);
            });
            
            cartTotal.textContent = `$${total.toFixed(2)}`;
        }

        function updateCartQuantity(productId, quantity) {
            if (quantity < 1) {
                removeFromCart(productId);
                return;
            }
            
            const item = cart.find(c => c.id === productId);
            const originalProduct = allProducts.find(p => p.id === productId);
            
            if (item && originalProduct) {
                if (quantity > originalProduct.quantity) {
                    showNotification(`Only ${originalProduct.quantity} items available`, 'warning');
                    return;
                }
                
                item.cartQuantity = quantity;
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartUI();
            }
        }

        function removeFromCart(productId) {
            cart = cart.filter(c => c.id !== productId);
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartUI();
            showNotification('Item removed from cart', 'info');
        }

        function openCart() {
            document.getElementById('cartModal').classList.add('active');
            updateCartModal();
        }

        function closeCart() {
            document.getElementById('cartModal').classList.remove('active');
        }

        function checkout() {
            if (cart.length === 0) {
                showNotification('Your cart is empty!', 'error');
                return;
            }
            
            showLoading(true);
            
            // Simulate checkout process
            setTimeout(() => {
                const total = cart.reduce((sum, item) => sum + (item.price * (item.cartQuantity || 1)), 0);
                const orderId = 'ORDER_' + Date.now();
                
                // Clear cart
                cart = [];
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartUI();
                
                showLoading(false);
                closeCart();
                
                showNotification(`Order confirmed! Total: $${total.toFixed(2)} | Order ID: ${orderId}`, 'success');
                
            }, 2000);
        }

        function handleSellForm(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const businessName = document.getElementById('businessName').value.trim();
            const images = document.getElementById('productImages').files;
            
            if (!businessName) {
                showNotification('Please enter your business name', 'error');
                return;
            }
            
            if (images.length === 0) {
                showNotification('Please upload at least one product image', 'error');
                return;
            }
            
            showLoading(true);
            
            // Process images
            const imagePromises = Array.from(images).map(file => {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.readAsDataURL(file);
                });
            });
            
            Promise.all(imagePromises).then(imageDataUrls => {
                // Create new product
                const newProduct = {
                    id: 'product_' + Date.now(),
                    name: formData.get('productName'),
                    description: formData.get('description'),
                    price: parseFloat(formData.get('price')),
                    category: formData.get('category'),
                    condition: formData.get('condition'),
                    quantity: parseInt(formData.get('quantity')),
                    businessName: businessName,
                    location: formData.get('location'),
                    locationName: locations.find(l => l.code === formData.get('location'))?.name || formData.get('location'),
                    sellerId: currentUser.id,
                    dateAdded: Date.now(),
                    views: 0,
                    likes: 0,
                    isOnline: true,
                    rating: '5.0',
                    image: imageDataUrls[0], // Primary image
                    images: imageDataUrls, // All images
                    phone: formData.get('phone'),
                    shipping: 'national',
                    returns: '14-days'
                };
                
                // Add to products array
                allProducts.unshift(newProduct);
                
                // Save to localStorage
                localStorage.setItem('allProducts', JSON.stringify(allProducts));
                
                // Save business name
                currentUser.businessName = businessName;
                localStorage.setItem('businessName', businessName);
                
                showLoading(false);
                showNotification('Product listed successfully! ðŸŽ‰ It\'s now live on the marketplace!', 'success');
                
                // Reset form
                document.getElementById('sellForm').reset();
                document.getElementById('imagePreview').innerHTML = '';
                document.getElementById('imagePreview').classList.add('hidden');
                
                // Update stats
                updateStats();
                
                // Show update indicator
                showUpdateIndicator();
                
                // Switch to marketplace to show the new product
                setTimeout(() => {
                    showSection('marketplace');
                    loadProducts(); // Refresh the marketplace
                }, 1000);
                
            }).catch(error => {
                console.error('Error processing images:', error);
                showLoading(false);
                showNotification('Error processing images. Please try again.', 'error');
            });
        }

        function handleImageUpload(e) {
            const files = Array.from(e.target.files);
            const preview = document.getElementById('imagePreview');
            
            if (files.length === 0) {
                preview.classList.add('hidden');
                return;
            }
            
            // Validate file types and sizes
            const validFiles = files.filter(file => {
                if (!file.type.startsWith('image/')) {
                    showNotification(`${file.name} is not a valid image file`, 'error');
                    return false;
                }
                if (file.size > 5 * 1024 * 1024) { // 5MB limit
                    showNotification(`${file.name} is too large. Maximum size is 5MB`, 'error');
                    return false;
                }
                return true;
            });
            
            if (validFiles.length === 0) {
                preview.classList.add('hidden');
                return;
            }
            
            preview.innerHTML = '';
            preview.classList.remove('hidden');
            
            validFiles.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const imageItem = document.createElement('div');
                    imageItem.className = 'image-preview-item';
                    imageItem.innerHTML = `
                        <img src="${e.target.result}" alt="Preview ${index + 1}">
                        <button type="button" class="image-preview-remove" onclick="removeImagePreview(${index})">
                            <i class="bi bi-x"></i>
                        </button>
                    `;
                    preview.appendChild(imageItem);
                };
                reader.readAsDataURL(file);
            });
        }

        function removeImagePreview(index) {
            const input = document.getElementById('productImages');
            const dt = new DataTransfer();
            const files = Array.from(input.files);
            
            files.forEach((file, i) => {
                if (i !== index) {
                    dt.items.add(file);
                }
            });
            
            input.files = dt.files;
            handleImageUpload({ target: input });
        }

        function previewProduct() {
            const formData = new FormData(document.getElementById('sellForm'));
            
            if (!formData.get('productName') || !formData.get('price') || !formData.get('description')) {
                showNotification('Please fill in required fields first', 'error');
                return;
            }
            
            const preview = {
                name: formData.get('productName'),
                price: parseFloat(formData.get('price')),
                description: formData.get('description'),
                category: formData.get('category'),
                condition: formData.get('condition'),
                quantity: parseInt(formData.get('quantity'))
            };
            
            showNotification(`Preview: ${preview.name} - $${preview.price} (${preview.category})`, 'info');
        }

        function saveDraft() {
            const formData = new FormData(document.getElementById('sellForm'));
            const draft = {};
            
            for (let [key, value] of formData.entries()) {
                draft[key] = value;
            }
            
            draft.businessName = document.getElementById('businessName').value;
            localStorage.setItem('sellFormDraft', JSON.stringify(draft));
            showNotification('Draft saved', 'success');
        }

        function loadDraft() {
            const draft = localStorage.getItem('sellFormDraft');
            if (!draft) {
                showNotification('No draft found', 'warning');
                return;
            }
            
            const data = JSON.parse(draft);
            
            Object.keys(data).forEach(key => {
                const element = document.querySelector(`[name="${key}"]`) || document.getElementById(key);
                if (element) {
                    element.value = data[key];
                }
            });
            
            showNotification('Draft loaded', 'success');
        }

        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('[id$="Section"]').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show target section
            document.getElementById(sectionName + 'Section').classList.remove('hidden');
            
            // Update navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            const activeLink = document.querySelector(`[onclick="showSection('${sectionName}')"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
            
            // Load section-specific content
            switch (sectionName) {
                case 'marketplace':
                    loadProducts();
                    break;
                case 'analytics':
                    loadUserAnalytics();
                    break;
            }
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function loadUserAnalytics() {
            const userProducts = allProducts.filter(p => p.sellerId === currentUser.id);
            const totalViews = userProducts.reduce((sum, p) => sum + (p.views || 0), 0);
            const totalSales = userProducts.reduce((sum, p) => sum + (p.sales || 0), 0);
            const totalRevenue = userProducts.reduce((sum, p) => sum + ((p.sales || 0) * p.price), 0);
            
            document.getElementById('totalListings').textContent = userProducts.length;
            document.getElementById('totalViews').textContent = totalViews.toLocaleString();
            document.getElementById('totalSales').textContent = totalSales.toLocaleString();
            document.getElementById('totalRevenue').textContent = `$${totalRevenue.toLocaleString()}`;
            
            // Load user products
            const userProductsGrid = document.getElementById('userProducts');
            userProductsGrid.innerHTML = '';
            
            if (userProducts.length === 0) {
                userProductsGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 4rem;">
                        <i class="bi bi-box" style="font-size: 4rem; color: #6b7280; margin-bottom: 1rem;"></i>
                        <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">No products listed yet</h3>
                        <p style="color: #9ca3af; margin-bottom: 2rem;">Start selling by adding your first product</p>
                        <button class="btn btn-primary" onclick="showSection('sell')">
                            <i class="bi bi-plus"></i> List Your First Product
                        </button>
                    </div>
                `;
                return;
            }
            
            userProducts.forEach(product => {
                const productCard = createProductCard(product);
                
                // Add edit/delete buttons for user's own products
                const editActions = document.createElement('div');
                editActions.style.cssText = 'display: flex; gap: 0.5rem; margin-top: 0.5rem;';
                editActions.innerHTML = `
                    <button class="btn btn-outline btn-sm" onclick="editProduct('${product.id}')" style="flex: 1;">
                        <i class="bi bi-pencil"></i> Edit
                    </button>
                    <button class="btn btn-outline btn-sm" onclick="deleteProduct('${product.id}')" style="color: #ef4444; border-color: #ef4444;">
                        <i class="bi bi-trash"></i> Delete
                    </button>
                `;
                
                productCard.querySelector('.product-content').appendChild(editActions);
                userProductsGrid.appendChild(productCard);
            });
        }

        function editProduct(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) {
                showNotification('Product not found', 'error');
                return;
            }
            
            // Switch to sell section and populate form
            showSection('sell');
            
            setTimeout(() => {
                document.getElementById('businessName').value = product.businessName;
                document.querySelector('[name="productName"]').value = product.name;
                document.querySelector('[name="description"]').value = product.description;
                document.querySelector('[name="price"]').value = product.price;
                document.querySelector('[name="category"]').value = product.category;
                document.querySelector('[name="condition"]').value = product.condition;
                document.querySelector('[name="quantity"]').value = product.quantity;
                document.querySelector('[name="location"]').value = product.location;
                document.querySelector('[name="phone"]').value = product.phone;
                
                showNotification(`Editing: ${product.name}`, 'info');
            }, 100);
        }

        function deleteProduct(productId) {
            if (!confirm('Are you sure you want to delete this product? This action cannot be undone.')) {
                return;
            }
            
            // Remove from products array
            allProducts = allProducts.filter(p => p.id !== productId);
            
            // Save to localStorage
            localStorage.setItem('allProducts', JSON.stringify(allProducts));
            
            // Remove from cart if present
            cart = cart.filter(item => item.id !== productId);
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartUI();
            
            // Update stats
            updateStats();
            
            loadUserAnalytics();
            showNotification('Product deleted successfully', 'success');
        }

        function exportAnalytics() {
            const userProducts = allProducts.filter(p => p.sellerId === currentUser.id);
            const exportData = {
                user: currentUser,
                products: userProducts,
                exportDate: new Date().toISOString(),
                summary: {
                    totalProducts: userProducts.length,
                    totalViews: userProducts.reduce((sum, p) => sum + (p.views || 0), 0),
                    totalSales: userProducts.reduce((sum, p) => sum + (p.sales || 0), 0),
                    totalRevenue: userProducts.reduce((sum, p) => sum + ((p.sales || 0) * p.price), 0)
                }
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `trading-hub-analytics-${Date.now()}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Analytics data exported successfully!', 'success');
        }

        function refreshAnalytics() {
            loadUserAnalytics();
            showNotification('Analytics refreshed', 'success');
        }

        function toggleQuickActions() {
            const quickActions = document.getElementById('quickActions');
            const fabIcon = document.getElementById('fabIcon');
            
            quickActions.classList.toggle('show');
            
            if (quickActions.classList.contains('show')) {
                fabIcon.className = 'bi bi-x';
            } else {
                fabIcon.className = 'bi bi-plus';
            }
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
            toggleQuickActions();
        }

        function toggleTheme() {
            showNotification('Theme switching coming soon!', 'info');
            toggleQuickActions();
        }

        function startLiveDemo() {
            showNotification('ðŸŽ¬ Starting live demo...', 'info');
            
            setTimeout(() => {
                showNotification('ðŸ“± Demo: Real-time product updates enabled', 'success');
            }, 1000);
            
            setTimeout(() => {
                showNotification('ðŸŒ Demo: Global search activated', 'success');
            }, 2000);
            
            setTimeout(() => {
                showNotification('â™¾ï¸ Demo: Infinite scroll ready', 'success');
            }, 3000);
            
            setTimeout(() => {
                showNotification('ðŸš€ Demo complete! Start by listing your first product!', 'success');
                showSection('sell');
            }, 4000);
        }

        function updateStats() {
            // Update hero stats with actual data
            const totalProducts = allProducts.length;
            const uniqueSellers = new Set(allProducts.map(p => p.sellerId)).size;
            
            document.getElementById('totalProducts').textContent = totalProducts.toLocaleString();
            document.getElementById('activeSellers').textContent = uniqueSellers.toLocaleString();
        }

        function showUpdateIndicator() {
            const indicator = document.getElementById('updateIndicator');
            indicator.classList.add('show');
            
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 3000);
        }

        function showLoading(show) {
            const overlay = document.getElementById('loadingOverlay');
            if (show) {
                overlay.style.display = 'flex';
            } else {
                overlay.style.display = 'none';
            }
        }

        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            const icons = {
                success: 'bi-check-circle-fill',
                error: 'bi-x-circle-fill',
                warning: 'bi-exclamation-triangle-fill',
                info: 'bi-info-circle-fill'
            };
            
            notification.innerHTML = `
                <i class="bi ${icons[type] || icons.info}"></i>
                <span>${message}</span>
            `;
            
            container.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, 5000);
        }

        function closeAllModals() {
            document.querySelectorAll('.modal.active').forEach(modal => {
                modal.classList.remove('active');
            });
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Initialize app when DOM is loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }
    </script>
</body>
</html>