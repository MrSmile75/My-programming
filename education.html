<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StoryVerse - Unlimited Story Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --accent-color: #ff6b6b;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --error-color: #dc3545;
            --dark-bg: #0a0a0a;
            --card-bg: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --border-radius: 15px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, var(--dark-bg) 0%, #1a1a2e 50%, #16213e 100%);
            color: var(--text-primary);
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--dark-bg);
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
        }

        /* Header Styles */
        .cosmic-header {
            position: relative;
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--primary-color) 100%);
            padding: 2rem 0;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .star-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .star {
            position: absolute;
            background: rgba(255,255,255,0.8);
            border-radius: 50%;
            animation: moveRight linear infinite, twinkle 2s infinite alternate;
        }

        @keyframes moveRight {
            from { transform: translateX(-10px); }
            to { transform: translateX(100vw); }
        }

        @keyframes twinkle {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        .header-content {
            position: relative;
            z-index: 10;
        }

        .logo-text {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            background: linear-gradient(45deg, var(--secondary-color), #fff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(37, 117, 252, 0.5);
        }

        .search-container {
            position: relative;
        }

        .search-input {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            color: var(--text-primary);
            border-radius: 25px;
            padding: 12px 50px 12px 20px;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .search-input:focus {
            background: rgba(255,255,255,0.15);
            border-color: var(--secondary-color);
            box-shadow: 0 0 20px rgba(37, 117, 252, 0.3);
            color: var(--text-primary);
        }

        .search-input::placeholder {
            color: var(--text-secondary);
        }

        .search-btn {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--secondary-color);
            font-size: 18px;
            cursor: pointer;
            transition: var(--transition);
        }

        .search-btn:hover {
            transform: translateY(-50%) scale(1.1);
            color: var(--primary-color);
        }

        /* Status Indicators */
        .status-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: var(--transition);
        }

        .status-indicator.show {
            opacity: 1;
            transform: translateX(0);
        }

        .status-indicator.warning {
            background: var(--warning-color);
        }

        .status-indicator.error {
            background: var(--error-color);
        }

        /* Story Counter */
        .story-counter {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--card-bg);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 25px;
            border: 2px solid var(--secondary-color);
            font-size: 14px;
            z-index: 1000;
        }

        /* Story Cards */
        .story-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            transition: var(--transition);
            border: 2px solid transparent;
            cursor: pointer;
            height: 100%;
            position: relative;
        }

        .story-card:hover {
            transform: translateY(-10px) scale(1.02);
            border-color: var(--secondary-color);
            box-shadow: 0 20px 40px rgba(37, 117, 252, 0.2);
        }

        .story-card-img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: var(--transition);
        }

        .story-card:hover .story-card-img {
            transform: scale(1.05);
        }

        .story-card-body {
            padding: 20px;
        }

        .story-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
            line-height: 1.4;
            height: 40px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .story-author {
            color: var(--text-secondary);
            font-size: 13px;
            margin-bottom: 10px;
        }

        .story-description {
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.4;
            margin-bottom: 15px;
            height: 60px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 4;
            -webkit-box-orient: vertical;
        }

        .story-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .story-genre {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
        }

        .story-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .preview-btn {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .preview-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .read-btn {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
        }

        .read-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(106, 17, 203, 0.4);
        }

        /* Story Reading Overlay */
        .story-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(10px);
        }

        .story-reader {
            background: var(--card-bg);
            width: 90%;
            max-width: 900px;
            height: 90%;
            border-radius: var(--border-radius);
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow);
            border: 2px solid var(--secondary-color);
        }

        .story-reader-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
        }

        .story-reader-title {
            font-size: 24px;
            font-weight: 600;
            color: white;
        }

        .close-reader {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: var(--transition);
        }

        .close-reader:hover {
            transform: scale(1.1);
            color: var(--accent-color);
        }

        .story-reader-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            line-height: 1.8;
            font-size: 16px;
        }

        .story-reader-content h1, .story-reader-content h2 {
            color: var(--secondary-color);
            margin-bottom: 20px;
        }

        .story-reader-content p {
            margin-bottom: 20px;
            text-align: justify;
        }

        /* Loading States */
        .loading-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            flex-direction: column;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(37, 117, 252, 0.3);
            border-top: 3px solid var(--secondary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: var(--text-secondary);
            font-size: 16px;
        }

        /* Auto-loading indicator */
        .auto-load-indicator {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card-bg);
            color: var(--text-primary);
            padding: 15px 25px;
            border-radius: 25px;
            border: 2px solid var(--secondary-color);
            z-index: 1000;
            display: none;
        }

        /* Search Results Info */
        .search-info {
            text-align: center;
            margin: 20px 0;
            color: var(--text-secondary);
        }

        .search-info.active {
            color: var(--secondary-color);
            font-weight: 600;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .cosmic-header {
                text-align: center;
                padding: 1.5rem 0;
            }

            .search-container {
                margin-top: 1rem;
            }

            .search-input {
                width: 100%;
            }

            .story-reader {
                width: 95%;
                height: 95%;
            }

            .story-reader-content {
                padding: 20px;
                font-size: 14px;
            }

            .story-reader-title {
                font-size: 20px;
            }

            .story-counter {
                top: 70px;
                right: 10px;
                padding: 8px 15px;
                font-size: 12px;
            }
        }

        /* Animation Classes */
        .fade-in {
            animation: fadeIn 0.6s ease forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* No Results */
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .no-results i {
            font-size: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <!-- Status Indicator -->
    <div id="status-indicator" class="status-indicator">
        <i class="fas fa-check"></i> Stories loaded successfully
    </div>

    <!-- Story Counter -->
    <div id="story-counter" class="story-counter">
        <i class="fas fa-book"></i> <span id="story-count">0</span> stories loaded
    </div>

    <!-- Auto-load Indicator -->
    <div id="auto-load-indicator" class="auto-load-indicator">
        <i class="fas fa-sync fa-spin"></i> Loading more stories...
    </div>

    <!-- Story Reading Overlay -->
    <div id="story-overlay" class="story-overlay">
        <div class="story-reader">
            <div class="story-reader-header">
                <h2 class="story-reader-title" id="reader-title">Story Title</h2>
                <button class="close-reader" id="close-reader">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="story-reader-content" id="reader-content">
                <!-- Story content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="cosmic-header">
        <div class="star-background" id="starField"></div>
        <div class="container header-content">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-5">
                        <span class="logo-text">📚 STORYVERSE</span>
                    </h1>
                    <p class="lead text-white-50">
                        Unlimited Stories from Real APIs - Search & Discover Endlessly
                    </p>
                </div>
                <div class="col-md-4 search-container">
                    <div class="position-relative">
                        <input 
                            type="text" 
                            id="searchInput" 
                            class="form-control search-input" 
                            placeholder="Search stories, authors, topics..."
                        >
                        <button id="searchButton" class="search-btn">
                            <i class="bi bi-search"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container mt-5">
        <!-- Search Info -->
        <div id="search-info" class="search-info">
            Continuously loading stories from multiple APIs...
        </div>

        <div class="row" id="storiesContainer">
            <!-- Stories will be auto-loaded here -->
        </div>

        <!-- Loading Spinner -->
        <div id="loadingSpinner" class="loading-container">
            <div class="loading-spinner"></div>
            <div class="loading-text">Fetching stories from APIs...</div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        class UnlimitedStoryPlatform {
            constructor() {
                // Configuration
                this.CACHE_DURATION = 15 * 60 * 1000; // 15 minutes
                this.REQUEST_DELAY = 800; // 800ms between requests
                this.MAX_RETRIES = 3;
                this.AUTO_LOAD_INTERVAL = 3000; // Load new stories every 3 seconds
                
                // API Configuration
                this.APIs = [
                    {
                        name: 'OpenLibrary',
                        baseUrl: 'https://openlibrary.org/search.json',
                        transform: this.transformOpenLibraryStory.bind(this)
                    },
                    {
                        name: 'Gutenberg',
                        baseUrl: 'https://gutendex.com/books',
                        transform: this.transformGutenbergStory.bind(this)
                    },
                    {
                        name: 'NewsAPI',
                        baseUrl: 'https://newsapi.org/v2/everything',
                        transform: this.transformNewsStory.bind(this)
                    }
                ];
                
                // State management
                this.cache = new Map();
                this.lastRequestTime = 0;
                this.isLoading = false;
                this.currentPage = 1;
                this.currentAPIIndex = 0;
                this.stories = new Set(); // Use Set to avoid duplicates
                this.searchQuery = '';
                this.autoLoadTimer = null;
                this.storyCounter = 0;
                
                // Search topics for continuous loading
                this.searchTopics = [
                    'fiction', 'adventure', 'mystery', 'romance', 'fantasy', 'science',
                    'history', 'biography', 'drama', 'comedy', 'thriller', 'horror',
                    'poetry', 'philosophy', 'art', 'music', 'travel', 'nature',
                    'technology', 'space', 'ocean', 'mountain', 'forest', 'city',
                    'love', 'friendship', 'family', 'courage', 'hope', 'dreams'
                ];
                this.currentTopicIndex = 0;
                
                // Initialize immediately
                this.init();
            }

            async init() {
                console.log('Initializing Unlimited Story Platform...');
                this.setupEventListeners();
                this.createStarBackground();
                
                // Start continuous loading immediately
                this.startContinuousLoading();
            }

            setupEventListeners() {
                const searchInput = document.getElementById('searchInput');
                const searchButton = document.getElementById('searchButton');
                const closeReader = document.getElementById('close-reader');

                // Search functionality
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.performSearch();
                    }
                });

                searchButton.addEventListener('click', () => {
                    this.performSearch();
                });

                // Clear search when input is empty
                searchInput.addEventListener('input', (e) => {
                    if (e.target.value.trim() === '') {
                        this.clearSearch();
                    }
                });

                // Close story reader
                closeReader.addEventListener('click', () => {
                    this.closeStoryReader();
                });

                // Close reader on overlay click
                document.getElementById('story-overlay').addEventListener('click', (e) => {
                    if (e.target === e.currentTarget) {
                        this.closeStoryReader();
                    }
                });

                // Manual load more on scroll
                window.addEventListener('scroll', this.throttle(() => {
                    if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 1000) {
                        this.loadMoreStories();
                    }
                }, 1000));

                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeStoryReader();
                    }
                });
            }

            createStarBackground() {
                const starField = document.getElementById('starField');
                const starCount = Math.floor(window.innerWidth / 20);
                
                for (let i = 0; i < starCount; i++) {
                    const star = document.createElement('div');
                    star.classList.add('star');
                    
                    const y = Math.random() * 200;
                    const size = Math.random() * 2 + 1;
                    const duration = (Math.random() * 10 + 5) + 's';
                    
                    star.style.cssText = `
                        top: ${y}px;
                        left: -10px;
                        width: ${size}px;
                        height: ${size}px;
                        animation-duration: ${duration};
                    `;
                    
                    starField.appendChild(star);
                    
                    star.addEventListener('animationend', () => {
                        star.remove();
                        if (starField.children.length < starCount) {
                            this.createStarBackground();
                        }
                    });
                }
            }

            startContinuousLoading() {
                console.log('Starting continuous story loading...');
                this.updateSearchInfo('Loading stories continuously from multiple APIs...');
                
                // Load initial batch
                this.loadStoriesFromAllAPIs();
                
                // Set up continuous loading
                this.autoLoadTimer = setInterval(() => {
                    if (!this.searchQuery) { // Only auto-load when not searching
                        this.loadStoriesFromAllAPIs();
                    }
                }, this.AUTO_LOAD_INTERVAL);
            }

            stopContinuousLoading() {
                if (this.autoLoadTimer) {
                    clearInterval(this.autoLoadTimer);
                    this.autoLoadTimer = null;
                }
            }

            async loadStoriesFromAllAPIs() {
                if (this.isLoading) return;
                
                this.isLoading = true;
                this.showAutoLoadIndicator();
                
                try {
                    // Get current search topic for variety
                    const topic = this.searchQuery || this.searchTopics[this.currentTopicIndex];
                    this.currentTopicIndex = (this.currentTopicIndex + 1) % this.searchTopics.length;
                    
                    // Load from multiple APIs simultaneously
                    const promises = this.APIs.map(api => this.fetchFromAPI(api, topic));
                    const results = await Promise.allSettled(promises);
                    
                    let newStoriesCount = 0;
                    results.forEach((result, index) => {
                        if (result.status === 'fulfilled' && result.value.length > 0) {
                            const addedCount = this.addStoriesToDisplay(result.value);
                            newStoriesCount += addedCount;
                            console.log(`Loaded ${addedCount} stories from ${this.APIs[index].name}`);
                        }
                    });
                    
                    if (newStoriesCount > 0) {
                        this.showStatus(`Loaded ${newStoriesCount} new stories`, 'success');
                    }
                    
                } catch (error) {
                    console.error('Error loading stories:', error);
                    this.showStatus('Error loading some stories', 'warning');
                } finally {
                    this.isLoading = false;
                    this.hideAutoLoadIndicator();
                }
            }

            async fetchFromAPI(api, query) {
                try {
                    let url;
                    
                    switch (api.name) {
                        case 'OpenLibrary':
                            url = `${api.baseUrl}?q=${encodeURIComponent(query)}&limit=20&page=${Math.floor(Math.random() * 10) + 1}`;
                            break;
                        case 'Gutenberg':
                            url = `${api.baseUrl}?search=${encodeURIComponent(query)}&page=${Math.floor(Math.random() * 10) + 1}`;
                            break;
                        case 'NewsAPI':
                            // Skip NewsAPI for now as it requires API key
                            return [];
                        default:
                            return [];
                    }
                    
                    const response = await this.makeAPIRequest(url);
                    
                    if (api.name === 'OpenLibrary' && response.docs) {
                        return response.docs.map(api.transform).filter(story => story.title && story.coverImage);
                    } else if (api.name === 'Gutenberg' && response.results) {
                        return response.results.map(api.transform).filter(story => story.title);
                    }
                    
                    return [];
                    
                } catch (error) {
                    console.error(`Error fetching from ${api.name}:`, error);
                    return [];
                }
            }

            async makeAPIRequest(url, useCache = true) {
                // Check cache first
                if (useCache && this.cache.has(url)) {
                    const cached = this.cache.get(url);
                    const now = Date.now();
                    if (now - cached.timestamp < this.CACHE_DURATION) {
                        return cached.data;
                    }
                }

                // Rate limiting
                const now = Date.now();
                const timeSinceLastRequest = now - this.lastRequestTime;
                if (timeSinceLastRequest < this.REQUEST_DELAY) {
                    await new Promise(resolve => 
                        setTimeout(resolve, this.REQUEST_DELAY - timeSinceLastRequest)
                    );
                }

                // Make request with retry logic
                for (let attempt = 1; attempt <= this.MAX_RETRIES; attempt++) {
                    try {
                        this.lastRequestTime = Date.now();
                        
                        const response = await fetch(url);
                        
                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                        }

                        const data = await response.json();
                        
                        // Cache the response
                        this.cache.set(url, {
                            data: data,
                            timestamp: now
                        });

                        return data;

                    } catch (error) {
                        console.error(`Attempt ${attempt} failed for ${url}:`, error);
                        if (attempt === this.MAX_RETRIES) {
                            throw error;
                        }
                        await new Promise(resolve => setTimeout(resolve, 1000 * attempt));
                    }
                }
            }

            transformOpenLibraryStory(story) {
                const publishYear = story.first_publish_year || 'Unknown';
                const author = story.author_name?.[0] || 'Unknown Author';
                const subject = story.subject?.[0] || 'Fiction';
                
                return {
                    id: `ol_${story.key?.replace('/works/', '') || Math.random().toString(36)}`,
                    title: story.title || 'Untitled Story',
                    author: author,
                    description: story.first_sentence?.[0] || `A captivating ${subject.toLowerCase()} story by ${author}. This work explores themes of human nature, relationships, and the complexities of life through engaging narrative and compelling characters.`,
                    genre: subject,
                    publishYear: publishYear,
                    coverImage: story.cover_i 
                        ? `https://covers.openlibrary.org/b/id/${story.cover_i}-M.jpg`
                        : `https://via.placeholder.com/300x400/1a1a1a/6a11cb?text=${encodeURIComponent(story.title?.substring(0, 20) || 'Story')}`,
                    content: this.generateStoryContent(story.title, author, story.first_sentence?.[0]),
                    source: 'OpenLibrary'
                };
            }

            transformGutenbergStory(story) {
                const author = story.authors?.[0]?.name || 'Unknown Author';
                const subject = story.subjects?.[0] || 'Classic Literature';
                
                return {
                    id: `gb_${story.id}`,
                    title: story.title || 'Untitled Classic',
                    author: author,
                    description: `A timeless classic from Project Gutenberg. This ${subject.toLowerCase()} work has been preserved for future generations and offers insights into ${story.subjects?.slice(0, 2).join(' and ') || 'human experience'}.`,
                    genre: subject,
                    publishYear: story.authors?.[0]?.birth_year || 'Classic',
                    coverImage: story.formats?.['image/jpeg'] || 
                        `https://via.placeholder.com/300x400/1a1a1a/2575fc?text=${encodeURIComponent(story.title?.substring(0, 20) || 'Classic')}`,
                    content: this.generateStoryContent(story.title, author),
                    source: 'Project Gutenberg'
                };
            }

            transformNewsStory(article) {
                return {
                    id: `news_${article.url?.split('/').pop() || Math.random().toString(36)}`,
                    title: article.title || 'News Story',
                    author: article.author || article.source?.name || 'News Reporter',
                    description: article.description || 'A current news story with important information and insights.',
                    genre: 'News',
                    publishYear: new Date(article.publishedAt).getFullYear(),
                    coverImage: article.urlToImage || 
                        'https://via.placeholder.com/300x400/1a1a1a/ff6b6b?text=News+Story',
                    content: this.generateNewsContent(article.title, article.content || article.description),
                    source: 'News API'
                };
            }

            generateStoryContent(title, author, firstSentence = '') {
                const templates = [
                    `<h1>${title}</h1>
                    <p><em>by ${author}</em></p>
                    
                    <h2>Chapter 1</h2>
                    <p>${firstSentence || 'In a world where stories come alive, our tale begins with an extraordinary discovery that will change everything.'}</p>
                    
                    <p>The morning sun cast long shadows across the landscape as our protagonist embarked on a journey that would test their courage, wisdom, and determination. Little did they know that this adventure would reveal truths about themselves and the world around them that they never could have imagined.</p>
                    
                    <h2>Chapter 2</h2>
                    <p>As the story unfolds, we discover that every choice has consequences, every action ripples through time, and every character we meet has their own story to tell. The narrative weaves together themes of love, loss, hope, and redemption in ways that speak to the universal human experience.</p>
                    
                    <p>Through trials and triumphs, our characters learn that the greatest adventures are not just about reaching a destination, but about the transformation that occurs along the way. Each page reveals new depths of meaning and connection.</p>
                    
                    <p><em>Continue reading to discover how this remarkable story unfolds...</em></p>`,
                    
                    `<h1>${title}</h1>
                    <p><em>A story by ${author}</em></p>
                    
                    <p>${firstSentence || 'This is a tale of wonder and discovery, where the impossible becomes possible and dreams take flight.'}</p>
                    
                    <p>In the pages that follow, you'll encounter characters who face challenges that mirror our own struggles and triumphs. Their journeys remind us that courage isn't the absence of fear, but the decision to move forward despite it.</p>
                    
                    <p>The narrative explores the depths of human emotion and the power of storytelling to connect us across time and space. Each chapter builds upon the last, creating a tapestry of meaning that resonates long after the final page is turned.</p>
                    
                    <p>Whether you're seeking adventure, romance, mystery, or simply a moment of escape from the everyday world, this story offers something special for every reader.</p>`
                ];
                
                return templates[Math.floor(Math.random() * templates.length)];
            }

            generateNewsContent(title, content) {
                return `
                    <h1>${title}</h1>
                    <p><em>Current News Story</em></p>
                    
                    <p>${content || 'This news story provides important information about current events and their impact on our world.'}</p>
                    
                    <p>Stay informed about the latest developments and understand how these events shape our society and future. News stories help us stay connected to the world around us and make informed decisions.</p>
                `;
            }

            addStoriesToDisplay(newStories) {
                let addedCount = 0;
                
                newStories.forEach(story => {
                    // Check for duplicates
                    if (!this.stories.has(story.id)) {
                        this.stories.add(story.id);
                        this.displaySingleStory(story);
                        addedCount++;
                        this.storyCounter++;
                    }
                });
                
                this.updateStoryCounter();
                return addedCount;
            }

            displaySingleStory(story) {
                const container = document.getElementById('storiesContainer');
                const storyCard = this.createStoryCard(story);
                container.appendChild(storyCard);
            }

            createStoryCard(story) {
                const col = document.createElement('div');
                col.className = 'col-lg-3 col-md-4 col-sm-6 mb-4';
                
                col.innerHTML = `
                    <div class="story-card fade-in">
                        <img src="${story.coverImage}" 
                             class="story-card-img" 
                             alt="${story.title} cover"
                             loading="lazy"
                             onerror="this.src='https://via.placeholder.com/300x400/1a1a1a/6a11cb?text=Story+Cover'">
                        <div class="story-card-body">
                            <h5 class="story-title">${this.truncateText(story.title, 60)}</h5>
                            <p class="story-author">by ${this.truncateText(story.author, 30)}</p>
                            <div class="story-meta">
                                <span class="story-genre">${story.genre}</span>
                                <span>${story.source}</span>
                            </div>
                            <p class="story-description">${this.truncateText(story.description, 150)}</p>
                            <div class="story-actions">
                                <button class="action-btn preview-btn" onclick="storyPlatform.previewStory('${story.id}')">
                                    <i class="fas fa-eye"></i> Preview
                                </button>
                                <button class="action-btn read-btn" onclick="storyPlatform.readStory('${story.id}')">
                                    <i class="fas fa-book-open"></i> Read
                                </button>
                            </div>
                        </div>
                    </div>
                `;

                // Store story data for later use
                col.dataset.storyData = JSON.stringify(story);
                
                return col;
            }

            performSearch() {
                const query = document.getElementById('searchInput').value.trim();
                if (!query) return;
                
                console.log('Performing search for:', query);
                this.searchQuery = query;
                this.stopContinuousLoading();
                this.clearStories();
                this.updateSearchInfo(`Searching for "${query}"...`, true);
                
                // Perform search across all APIs
                this.searchAllAPIs(query);
            }

            async searchAllAPIs(query) {
                this.isLoading = true;
                this.showAutoLoadIndicator();
                
                try {
                    const promises = this.APIs.map(api => this.fetchFromAPI(api, query));
                    const results = await Promise.allSettled(promises);
                    
                    let totalResults = 0;
                    results.forEach((result, index) => {
                        if (result.status === 'fulfilled' && result.value.length > 0) {
                            const addedCount = this.addStoriesToDisplay(result.value);
                            totalResults += addedCount;
                        }
                    });
                    
                    this.updateSearchInfo(`Found ${totalResults} stories for "${query}"`, true);
                    
                    if (totalResults === 0) {
                        this.showNoResults(query);
                    }
                    
                } catch (error) {
                    console.error('Search error:', error);
                    this.showStatus('Search failed. Please try again.', 'error');
                } finally {
                    this.isLoading = false;
                    this.hideAutoLoadIndicator();
                }
            }

            clearSearch() {
                this.searchQuery = '';
                this.clearStories();
                this.updateSearchInfo('Resuming continuous loading...');
                this.startContinuousLoading();
            }

            loadMoreStories() {
                if (this.searchQuery) {
                    this.searchAllAPIs(this.searchQuery);
                } else {
                    this.loadStoriesFromAllAPIs();
                }
            }

            previewStory(storyId) {
                const storyElement = document.querySelector(`[data-story-data*='"id":"${storyId}"']`);
                if (storyElement) {
                    const story = JSON.parse(storyElement.dataset.storyData);
                    this.showStatus(`Preview: "${story.title}" by ${story.author} - ${story.genre}`, 'success');
                    storyElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }

            readStory(storyId) {
                const storyElement = document.querySelector(`[data-story-data*='"id":"${storyId}"']`);
                if (storyElement) {
                    const story = JSON.parse(storyElement.dataset.storyData);
                    this.openStoryReader(story);
                }
            }

            openStoryReader(story) {
                const overlay = document.getElementById('story-overlay');
                const title = document.getElementById('reader-title');
                const content = document.getElementById('reader-content');
                
                title.textContent = story.title;
                content.innerHTML = story.content;
                
                overlay.style.display = 'flex';
                document.body.style.overflow = 'hidden';
                
                this.showStatus(`Reading: "${story.title}"`, 'success');
            }

            closeStoryReader() {
                const overlay = document.getElementById('story-overlay');
                overlay.style.display = 'none';
                document.body.style.overflow = 'auto';
            }

            clearStories() {
                document.getElementById('storiesContainer').innerHTML = '';
                this.stories.clear();
                this.storyCounter = 0;
                this.updateStoryCounter();
            }

            showNoResults(query) {
                const container = document.getElementById('storiesContainer');
                container.innerHTML = `
                    <div class="col-12">
                        <div class="no-results">
                            <i class="fas fa-search"></i>
                            <h3>No stories found for "${query}"</h3>
                            <p>Try searching with different keywords or clear the search to resume auto-loading.</p>
                        </div>
                    </div>
                `;
            }

            updateSearchInfo(message, isActive = false) {
                const searchInfo = document.getElementById('search-info');
                searchInfo.textContent = message;
                searchInfo.className = isActive ? 'search-info active' : 'search-info';
            }

            updateStoryCounter() {
                document.getElementById('story-count').textContent = this.storyCounter;
            }

            showAutoLoadIndicator() {
                document.getElementById('auto-load-indicator').style.display = 'block';
            }

            hideAutoLoadIndicator() {
                document.getElementById('auto-load-indicator').style.display = 'none';
            }

            showStatus(message, type = 'success') {
                const indicator = document.getElementById('status-indicator');
                const icons = {
                    success: 'check',
                    warning: 'exclamation-triangle',
                    error: 'times'
                };
                
                indicator.innerHTML = `<i class="fas fa-${icons[type]}"></i> ${message}`;
                indicator.className = `status-indicator ${type}`;
                indicator.classList.add('show');
                
                setTimeout(() => {
                    indicator.classList.remove('show');
                }, 3000);
            }

            truncateText(text, length) {
                if (!text) return 'N/A';
                return text.length > length ? text.substring(0, length) + '...' : text;
            }

            throttle(func, delay) {
                let timeoutId;
                let lastExecTime = 0;
                return function (...args) {
                    const currentTime = Date.now();
                    
                    if (currentTime - lastExecTime > delay) {
                        func.apply(this, args);
                        lastExecTime = currentTime;
                    } else {
                        clearTimeout(timeoutId);
                        timeoutId = setTimeout(() => {
                            func.apply(this, args);
                            lastExecTime = Date.now();
                        }, delay - (currentTime - lastExecTime));
                    }
                };
            }
        }

        // Initialize the platform immediately
        const storyPlatform = new UnlimitedStoryPlatform();

        // Prevent right-click (optional)
        document.addEventListener('contextmenu', e => e.preventDefault());
    </script>
</body>
</html>